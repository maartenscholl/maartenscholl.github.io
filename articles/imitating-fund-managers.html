<!doctype html><html lang=en><meta charset=utf-8><title>Imitating Fund Managers using GANs</title><link href=/favicon.svg rel=icon type=image/svg+xml><meta content="Simulating Financial Markets" property=og:title><meta property=og:description><meta property=og:image><meta property=og:url><meta content=article property=og:type><meta content=width=device-width,initial-scale=1 name=viewport><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://fonts.googleapis.com/css2?family=Merriweather+Sans:ital,wght@0,300..800;1,300..800&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&display=swap rel=stylesheet><link as=font crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Size1-Regular.woff2 rel=preload type=font/woff2><link as=font crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Size2-Regular.woff2 rel=preload type=font/woff2><link as=font crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Size3-Regular.woff2 rel=preload type=font/woff2><link as=font crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Size4-Regular.woff2 rel=preload type=font/woff2><link as=font crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/fonts/KaTeX_Main-Regular.woff2 rel=preload type=font/woff2><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css integrity=sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib rel=stylesheet><script crossorigin defer integrity=sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script><link href=/theme/css/main.css rel=stylesheet><script>document.addEventListener(`DOMContentLoaded`,(()=>{document.querySelectorAll(`a[href^="#"]`).forEach(a=>{const b=a.getAttribute(`href`).substring(1);const c=document.getElementById(b);if(!c){a.addEventListener(`click`,(a=>{a.preventDefault();document.querySelectorAll(`.tooltip-popup`).forEach(a=>a.remove());const b=document.createElement(`div`);b.classList.add(`tooltip-popup`);b.innerText=`This reference is unavailable.`;const c=document.documentElement.scrollTop||document.body.scrollTop;const d=document.documentElement.scrollLeft||document.body.scrollLeft;b.style.left=`${a.clientX}px`;b.style.top=`${a.clientY}px`;b.style.left=`${a.clientX+ d}px`;b.style.top=`${a.clientY+ c}px`;document.body.appendChild(b);setTimeout(()=>{if(document.body.contains(b)){b.remove()}},3000)}))}})}))</script><body><header class=navigation><div class=navigation-inner><a aria-label="Site name" class=site-name href=/>Simulating Financial Markets</a><nav aria-label="Site navigation" class=top-menu><ul class=mmli><li><a class="mml mmi2" href=/>Overview</a><li><a class="mml mmi3" href=/research.html>Research</a><li><a class="mml mmi4 mms4" href=/articles/>Articles</a><li><a class="mml mmi5" href=/software.html>Software</a><li><a class="mml mmi6" href=/contact.html>Contact</a></ul></nav></div></header><main class="entry-content page-container"><header class="article-header-container background-image-container"><div class=background-image-small><div class=title-container><h1>Imitating Fund Managers using GANs</h1><h4>A chapter from the thesis <em>The Market as an Ecosystem</em></h4></div></div><aside aria-label="Article category information" class=post-meta><a href=/category/finance.html><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/NGC_3923_Elliptical_Shell_Galaxy.jpg/220px-NGC_3923_Elliptical_Shell_Galaxy.jpg " alt=Finance class=post-avatar></a><figcaption class=meta-data><a class=author href=/author/maarten-p-scholl.html>Maarten P. Scholl</a> <div>Category:</div> <a class=category href=/category/finance.html>Finance</a><br> <time title=2024-08-11>2024-08-11</time></figcaption></aside></header><section class=entry-content><div class=toc><ul><li><a href=#chapter:species>Species of Investors</a><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#section:motivation_new_classification>Motivation</a><ul><li><a href=#overview-of-existing-methods>Overview of Existing Methods</a><li><a href=#section:species_limitations_existing_methods>Limitations of Existing Fund Methods</a></ul><li><a href=#section:strategies_objectives>Objectives</a><ul><li><a href=#equation:gan_objectives>Operational Objectives</a></ul></ul><li><a href=#section:species_methods>Holdings-Based Investment Strategy Analysis</a><ul><li><a href=#section:identifiability_strategies>Identifiability of Strategies</a><ul><li><a href=#section:trading_positions_in_time>Reconstructing Positions in Time</a><li><a href=#section:trading_signal_frequency>Trading Signal Frequency</a></ul><li><a href=#section:data_coverage_portfolios>Data and Coverage</a><ul><li><a href=#section:balance_sheet_model>The Fund Balance Sheet</a></ul><li><a href=#equation:portfolio_exposure_models>Style Classification</a><ul><li><a href=#section:portfolio_projections_factors>Projections of Portfolios on Factors</a><li><a href=#section:factor_models_to_portfolios>Factor Models applied to Portfolios</a><li><a href=#section:lipper_model>Lipper Classification Methodology</a><ul><li><a href=#reference-index>Reference Index</a><li><a href=#section:lipper_class_details>Lipper Model Steps</a></ul></ul><li><a href=#section:strategy_overview_leverage>Leverage Ratio</a><li><a href=#section:portfolio_optimisation>Portfolio Optimisation</a><li><a href=#section:turnover_rate_analysis>Turnover Rate</a></ul><li><a href=#experiments>Experiments</a><ul><li><a href=#section:comparison_with_lipper>Model Alignment</a><ul><li><a href=#section:procrustes_analysis>Procrustes Analysis</a><li><a href=#section:model_equivalence_testing>Model Equivalence Testing</a><li><a href=#diversity-of-risk-factors>Diversity of Risk Factors</a></ul><li><a href=#section:classifier_stability>Stability</a><li><a href=#section:markowitz_optimality_experiment>Markowitz-Optimality</a><ul><li><a href=#section:markowitz_optimality_null_model>Null-Hypothesis</a></ul><li><a href=#section:learning_to_invest>Learning to Allocate a Portfolio</a><ul><li><a href=#section:gans>Methods</a><li><a href=#section:gan_validation>Validation</a><li><a href=#discriminators-loss-function>Discriminator’s Loss Function</a><li><a href=#evaluation>Evaluation</a></ul></ul><li><a href=#results>Results</a><ul><li><a href=#section:analysis_stability>Stability</a><li><a href=#section:analysis_markowitz_optimality>Analysis of Markowitz-Optimality</a><li><a href=#section:learning_to_manage_portfolio>Learning to Manage a Portfolio</a><ul><li><a href=#section:style_representation_experiment>Style Representation</a><li><a href=#optimisation-and-turnover>Optimisation and Turnover</a></ul><li><a href=#results-on-anchor-metrics>Results on Anchor-Metrics</a><li><a href=#section:gan_based_unsupervised_strategy>GAN-based Unsupervised Strategy Learning</a></ul><li><a href=#conclusions>Conclusions</a><ul><li><a href=#discussion>Discussion</a></ul></ul></ul></div><h1 id=chapter:species>Species of Investors<a title="Permanent link" class=headerlink href=#chapter:species></a></h1><h2 id=introduction>Introduction<a title="Permanent link" class=headerlink href=#introduction></a></h2><p>Investment strategies vary widely in their objectives, styles, management and execution. Understanding these strategies is essential for practitioners, regulators, and researchers investigating asset pricing and market dynamics. Traditional classifications, like those provided by Morningstar and Lipper, rely on broad style categories. While useful, these methods often fail to capture the complexity of real-world portfolios and the underlying trading strategies. A detailed understanding of portfolio management to the level of implementation is necessary in order to be able to realistically simulate financial markets in, for example, agent-based models.<p>This chapter builds on the factor model introduced in Chapter <a href=#chapter:return_attribution>3</a> to characterize long-term investment strategies through a combination of data analysis, risk-factor modelling, and representation learning.<h3 id=section:motivation_new_classification>Motivation<a title="Permanent link" class=headerlink href=#section:motivation_new_classification></a></h3><p>In the overview of different models of thinking in Chapter <a href=#chapter:background>2</a>, Sections <a href=#section:standard_economic_models>2.1</a>-<a href=#section:General_equilibrium>2.5</a>, we investigated models of rational behaviour and models of classical finance. We question how these models translate to the real world, and how we identify investment strategies in the data. This directly answers Research Question 1 (Section <a href=#section:research_question_1>1.3</a>).<p>We want to understand whether this regulatory filing data, that is made publicly available with the express purpose to make investors gain trust in financial markets, is sufficient to really understand what managers do. This combined work, of data analysis and bottom-up strategy replication, allows us to get a better understanding of how these funds manage their portfolios and allows us to systematically learn how to construct and manage such portfolios.<h4 id=overview-of-existing-methods>Overview of Existing Methods<a title="Permanent link" class=headerlink href=#overview-of-existing-methods></a></h4><p>Our approach is motivated by a survey of existing work on classifying the strategies and styles of investment funds, which we summarise in Table <a href=#table:classification_schemes>[table:classification_schemes]</a>.<p>Surveying all the methods in Table <a href=#table:classification_schemes>[table:classification_schemes]</a>, we find that most approaches are easily replicated, with the exception of Morningstar’s categories where the white-paper is unclear details to replicate the exact results, and the MSCI methods which are proprietary. Selecting only those schemes that we can replicate on our universe of U.S. equities, the Lipper scheme is the most comprehensive: due to its larger amount of factors it includes other models. On top of this, the Lipper database also provides the stated objectives of funds from prospectuses, and so it provides additional insight into the managers’ intentions.<h4 id=section:species_limitations_existing_methods>Limitations of Existing Fund Methods<a title="Permanent link" class=headerlink href=#section:species_limitations_existing_methods></a></h4><p>Characterisation of the portfolios requires addressing several aspects: the exposure of the portfolio to the risk factors as the investment style, the use of borrowing or leverage, how these exposures compare to peers with the same stated objectives, optimising behaviour, the stability of the of the investment style, and learning to trade from reconstructed portfolios. All of these aspects have the potential to affect future returns. While top-down approaches, which correlate funds’ returns with known index portfolios constructed in the same universe [@Sharpe1992AssetAllocation; @Hasanhodzic2007CanCase], can characterise funds’ risk-factors reliably, they do not reveal whether a fund optimises or uses leverage and how they manage risk in a way that results in a full replication of the strategy. Although the predictive power for future performance of the ranking systems built on top of the style classification is rather limited (see, e.g., [@Blake2000MorningstarPerformance]), an empirical observation in fund management is that investors make investment decisions based on historical performance within style peer-groups [@Chevalier1997RiskIncentives], thus underscoring the importance of accurate grouping.<p>When the Carhart model is used as the ground truth for risk factors in a portfolio, 14% of funds are found to be misclassified between 2003 and 2016, according to [@Bams2017InvestmentPerformance]. Market dynamics may lead to investments migrating from one category to another, faster than the manager can adjust their portfolio leading to tracking error. In reviews of existing classification systems, it is found that historically significant numbers of mutual funds are incorrectly classified due to these combined effects [@Kim2000MutualMisclassification]. In the literature on mutual funds, researchers have discovered individual cases of portfolios moving away from stated investment objectives, and the multiple reasons for why this may happen fall under the term of [@Wermers2012MatterPortfolios].<p>Modelling multiple opponents in an adaptive, non-stationary game can be effectively approached by learning deep representations, as demonstrated in dynamic, multi-agent reinforcement learning settings [@He2015]. These methods highlight that high-dimensional data describing the actions of players or agents can be effectively encoded and represented using deep neural networks. Such representations allow the model to generalise across varying strategies and adapt to changing dynamics. Learning in a continuum of opponent strategies may be an advantageous setting, as in practice opponent modelling still performs well when presented with mixtures of pure opponent strategies the learner is already familiar with [@Smith2020LearningOpponents].<p>Many settings in the opponent modelling field assume interaction between the learner and the opponent agents. These settings are often explored in simulation because then the learner can better explore agents’ behaviours by adjusting its own actions. Regulatory reporting data is static and not as abundant as the number of evaluations of a simulation, and so there is a risk of overfitting, where the learner does not generalise behaviour but only recalls individual responses in specific contexts.<p>A class of neural networks called generative adversarial networks (Section <a href=#section:gans>1.3.4.1</a> for a discussion) have been used to extend real data with realistic synthetic data, to enhance training of downstream tasks such as trading strategies [@Eckerli2021GenerativeOverview]. They have been applied in the context of portfolio management [@Mariani2019PAGAN:Networks] to better model the dynamics of the underlying instruments in a Markowitz-style framework, on top of which a trading strategy then can be tested.<p>We can however model the dynamics of the financial instruments through our factor model, and so our focus shifts more towards learning representations for the observed strategies in the data.<p>In the literature of generative models, it is often the case that the exact criteria for replicated behaviours to be realistic is hard to define, but these can be learned in a competitive setting between generator and discriminator [@Goodfellow2014GenerativeNetworks]. The use of discriminators in the loss function means the network can implicitly learn what defines a certain strategy, and so it doesn’t need to rely on an exhaustive list of criteria relevant to classify a strategy.<h3 id=section:strategies_objectives>Objectives<a title="Permanent link" class=headerlink href=#section:strategies_objectives></a></h3><p>The main objective of this chapter is to gain a thorough understanding of investment strategies, that is both practical – in that it allows us to simulate realistic investment funds, as well as comprehensive – in that we can relate it to the theoretical frameworks of academic finance.<p>We analyse portfolios based on their typical risk-factor exposures, their alignment with benchmarks, and their adherence to mean-variance optimisation principles. This characterization provides an operational understanding of fund strategies beyond labels. We want to validate our classification by investigating the stability of the exposure-based classification for major funds, for which we have long periods of holding data.<p>Having decomposed returns into constituent risk factors in Chapter <a href=#chapter:return_attribution>3</a>, we briefly revisit the factor model to analyse the risk factor exposures at the portfolio level in order to understand the composition of portfolios of different styles in Section <a href=#equation:portfolio_exposure_models>1.2.3</a>. We compare these classifications to the existing Lipper style-score methodology. In the diagram of Figure <a href=#figure:diagram_portfolio_management>1.1</a>, we display the various aspects of portfolio management discussed in this chapter, and we link to the sections that discuss these separate topics.<figure id=figure:diagram_portfolio_management><figcaption>This diagram summarises the aspects of portfolio management that we explore in this chapter.</figcaption></figure><h4 id=equation:gan_objectives>Operational Objectives<a title="Permanent link" class=headerlink href=#equation:gan_objectives></a></h4><p>Our objective when learning strategies from data is to learn a latent representation <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=bold>ϕ</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>\mathbf{\phi}_a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> of portfolio behaviour directly from the portfolio data triple <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi mathvariant=bold>w</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbf{X}, \mathbf{r}, \mathbf{w})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class=mopen>(</span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mclose>)</span></span></span></span>, meaning the characteristics <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>X</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>k</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>X_{i,k,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathnormal" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0785em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style=margin-right:.03148em>k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> of the investments, the returns <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>60</mn><mo>:</mo><mi>t</mi><mrow><mo>−</mo><mn>1</mn></mrow></mrow></msub></mrow><annotation encoding=application/x-tex>r_{i,t{-}60:t{-1}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">60</span><span class="mrel mtight">:</span><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span>, and the weights <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>w_{a, i, t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span>. The latent representation <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=application/x-tex>\phi</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class="mord mathnormal">ϕ</span></span></span></span> for one fund manager <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span> is fixed to a small number of variables whereas the decoder needs to be able to deal with variable numbers of stocks <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> and long histories of the time series of the returns <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>r</mi></mrow><annotation encoding=application/x-tex>\mathbf{r}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf">r</span></span></span></span>.<p>Formally, we model the conditional probability: <span id=equation:portfolio_manager_decoder></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>p</mi><mo stretchy=false>(</mo><mi mathvariant=bold>w</mi><mi mathvariant=normal>∣</mi><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><msub><mi>ϕ</mi><mi>a</mi></msub><mo stretchy=false>)</mo><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex> p(\mathbf{w} | \mathbf{X}, \mathbf{r}, \phi_{a}), </annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class="mord mathnormal">p</span><span class=mopen>(</span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mord>∣</span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mpunct>,</span></span></span></span></span><p>where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=bold>ϕ</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>\mathbf{\phi}_a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is a low-dimensional latent variable specific to manager <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span>’s strategy.<p>In order to learn strategy representations for real-world funds, we extend our factor model with a strategy classifying component and a discriminator. These will be discussed in Section <a href=#equation:gan_objectives>1.1.2.1</a>.<h2 id=section:species_methods>Holdings-Based Investment Strategy Analysis<a title="Permanent link" class=headerlink href=#section:species_methods></a></h2><p>In this section, we outline the methodology used to characterise real-world portfolios, determine their strategy and make a classification, evaluate the stability, and derive portfolio-management and risk management components from the data.<h3 id=section:identifiability_strategies>Identifiability of Strategies<a title="Permanent link" class=headerlink href=#section:identifiability_strategies></a></h3><p>We identify two important aspects of portfolio processes that can be directly calibrated to regulatory reports. The first are positions at a point in time, which are captured in so-called holdings reports. The second aspect are the dynamics, which are more difficult to characterise but for which we have such statistics as the turnover rate that we can directly use in calibration.<h4 id=section:trading_positions_in_time>Reconstructing Positions in Time<a title="Permanent link" class=headerlink href=#section:trading_positions_in_time></a></h4><p>Markets are open to trade most business-days of the year. However, we only have holdings data at most at a monthly frequency. There also exists uncertainty about the precise moment in time to which the portfolio applies for the following reasons. Regulators typically ask for the last reporting period date and allow the fund manager to pick the nearest preceding business day so that the manager can use actual market prices to value their portfolio. However, markets worldwide adhere to different calendars, meaning some of them will be closed, and therefore the view on the portfolio may not be consistent. On top of this, we frequently encounter stale data in the reports. Hypothetically in cases where an instrument’s price does not cross the same reported price more than once, we can determine that the market prices used in the report must be several days or weeks older. However, prices are volatile, making it impossible to automate correcting these errors.<h4 id=section:trading_signal_frequency>Trading Signal Frequency<a title="Permanent link" class=headerlink href=#section:trading_signal_frequency></a></h4><p>The data constraints described in Section <a href=#section:trading_positions_in_time>1.2.1.1</a> make identifying the dynamic strategies difficult, as their frequency is much lower than that of the signals in market data that may influence the portfolio choice. The low frequency of portfolio holdings reports means that if a fund manager trades frequently, we cannot fully reconstruct their strategy. We ask whether there exist some methods to inform us about how much we can reconstruct<p>The Nyquist-Shannon <em>sampling theorem</em> tells us that, to fully resolve a frequency-limited signal, we need to sample at a rate of at least twice the highest frequency in the signal. When we sample at a frequency less than the highest important frequency of the trading signal, we cannot accurately recover the signal and instead up with a signal <em>alias</em>, which not only is likely to have a frequency that is much too low but may in rare cases also result in complete loss of the signal. Suppose the manager buys and sells the same instrument in a given period between the known reports at time points <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>t{-}1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.0833em;height:.7278em></span><span class="mord mathnormal">t</span><span class=mord><span class=mord>−</span></span><span class=mord>1</span></span></span></span>. We only observe the net position that resulted from these trades at time <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span>. If an investment strategy depends on signals that are a higher frequency than twice our monthly holdings positions, we are downsampling, and we may mischaracterise those strategies. We expect this to be the case for strategies that depend on high-frequency indicators, such as technical trading strategies that derive their signal from market prices and volumes, such as momentum strategies. On the other side, fundamental strategies based on slow economic indicators, such as the firms’ earnings reports, have a natural frequency of a quarter year between data points and are therefore resolvable.<p>Specialist financial entities such as market makers are known to only hold positions for brief periods, rarely maintaining risky positions between market sessions or over the end of a reporting period [@KIRILENKO2017]: we cannot model strategies that rely on clever order placement and intraday positions, such as high-frequency market makers and arbitrageurs. We do not observe the individual trades, nor the details of the orders submitted to a market to engage in those trades. For these reasons it is unlikely that we will be able reconstruct meaningful strategies for these types of financial market participants, and hence our focus shifts to long-term investment funds such as mutual funds.<h3 id=section:data_coverage_portfolios>Data and Coverage<a title="Permanent link" class=headerlink href=#section:data_coverage_portfolios></a></h3><p>We use institutional portfolio holdings data and U.S. equities’ market data as the basis for this study. We re-use the risk-factor exposures or loadings from Chapter <a href=#chapter:return_attribution>3</a>(<a href=#equation:factor_model_restated>this equation</a>). The holdings data represent positions at the portfolio level. The data is updated at, depending on regulatory regime and voluntary public disclosure, quarterly to monthly intervals. As data quality and coverage constrains our analysis, our primary investigation uses a commercial compilation of cleaned up public reports at the portfolio level. These are obtained from the CRSP Survivor-Bias-Free US Mutual Funds database[@CRSPPrices], based on the work by [@Wermers2000MutualExpenses]. Portfolio-level data in the format of the Securities and Exchanges Commissions’ forms are essential to our risk-factor exposure based classification. Aggregation at the level of a financial firms prevents us from doing a reliable strategy classification, though that is the case for other forms such as . In light of research in later chapters (Chapter <a href=#chapter:hypothesis>[chapter:hypothesis]</a>) where the total holdings explained through regulatory reports become important, we do a more extensive investigation into public regulatory filings at the legal entity level in Appendix <a href=#appendix:regulatory_filings>A</a>.<p>We narrow down out data to periods and portfolios that have good coverage. We define the threshold to be that 75% of the market value of the portfolio must be explained by our factor model, meaning for that portion the factor loadings are reliably estimated. A portfolio also must have at least one year’s of observations, and over the period it is observed at least 75% of the time it must have complete data. To make comparison possible, we also select those funds that have a classification by an existing classification system, in this case a Lipper class (classifying the fund in the wider mutual fund landscape) and a Lipper objective code (categorising the objectives set out in the prospectus).<p>Compared to the financial instrument data, we have a relatively short span of high-quality portfolio data with wide coverage. Accordingly, in this chapter, we fit models using data from 2010 to 2018 and validate them using data from 2019 to 2022. For qualitative analysis, all visualization samples are drawn from December 31, 2019. This date marks the end of the year, which for many firms marks also the end of a fiscal year and coincides with an annual report, which is typically when numbers are most accurate. This date in 2019 is the month with the highest number of complete portfolio reports, providing the richest dataset for visualisation.<h4 id=section:balance_sheet_model>The Fund Balance Sheet<a title="Permanent link" class=headerlink href=#section:balance_sheet_model></a></h4><p>We denote by <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo separator=true>,</mo><mi>w</mi><mo>∈</mo><mi mathvariant=double-struck>R</mi></mrow><annotation encoding=application/x-tex>w_{a,i,t}, w \in \mathbb{R}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.8252em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6889em></span><span class="mord mathbb">R</span></span></span></span> the weight of an investment <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> in the portfolio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span> at time <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span>. In the reports, the weight is officially the allocation fraction of total net assets, and is computed by the fund using the appropriate accounting methodology. In rare cases where the investment is recorded but the percentage is not provided, we recompute them using mark-to-market accounting if other values such as the number of contracts or the notional is provided. In older reports, mainly before the 2000s, the specification demanded human-readability of the documents, and in such cases numbers are often rounded leading to many investments receiving a zero weight. In such cases we also recompute the weight using mark-to-market valuation. If the (TNA) of a fund are defined as: <span id=equation:total_net_assets></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>W</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>S</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>W_{a,t} = \sum_{i=1}^{I} S_{a,i,t} p_{i,t},</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.1389em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.2777em;height:3.106em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mpunct>,</span></span></span></span></span><p>then, the allocation fraction for instrument <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> can be computed as: <span id=equation:allocation_quantity_based></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>S</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><msub><mi>W</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mfrac><mo>=</mo><mfrac><mrow><msub><mi>S</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>S</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow></mfrac><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>w_{a,i,t} = \frac{S_{a,i,t} p_{i,t}}{W_{a,t}} = \frac{S_{a,i,t} p_{i,t}}{\sum_{i=1}^{I} S_{a,i,t} p_{i,t}}.</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.9721em;height:2.3324em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3603em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.1389em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9721em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.1709em;height:2.5313em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3603em><span style=top:-2.1288em><span class=pstrut style=height:3em></span><span class=mord><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=margin-right:.05em;top:-3.2029em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.1709em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord>.</span></span></span></span></span><p>The portfolio allocations or portfolio weights tell us what fraction of total net assets is invested in a certain instrument. The weight can be negative, when the instrument <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> represents a liability such as a short position.<h3 id=equation:portfolio_exposure_models>Style Classification<a title="Permanent link" class=headerlink href=#equation:portfolio_exposure_models></a></h3><p>In this section we discuss the benchmark methods to which we compare our approach. As discussed in the Motivation (Section <a href=#section:motivation_new_classification>1.1.1</a>), we settle on using the Lipper Style Classification methodology as the benchmark, as we can replicate it closely.<h4 id=section:portfolio_projections_factors>Projections of Portfolios on Factors<a title="Permanent link" class=headerlink href=#section:portfolio_projections_factors></a></h4><p>Motivated by our intent to classify portfolios using only those factors that explain returns, in this section we explore the direct projection of the investment portfolios on the (latent) factors uncovered using the deep learning model in Chapter <a href=#chapter:return_attribution>3</a>.<p>In subsection <a href=#section:factor_models_to_portfolios>1.2.3.2</a>, we discuss the expectations we have about applying factor models to portfolios in the theoretical framework on which the model is built. We then relax these assumptions and consider which other aspects of portfolios we might want to capture, in Subsection <a href=#section:portfolio_optimisation>1.2.5</a>.<h4 id=section:factor_models_to_portfolios>Factor Models applied to Portfolios<a title="Permanent link" class=headerlink href=#section:factor_models_to_portfolios></a></h4><p>Recall the factor model of instruments’ returns in <a href=#equation:factor_model_restated>this equation</a>, and the allocation vector <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>w_{a,i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> being the weights of the instrument <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> in the portfolio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span> at time <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span> (<a href=#equation:allocation_quantity_based>this equation</a>). We expect that the log return of the portfolio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>r</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>r_{a,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span>, as defined by the allocation fractions <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>w_{a,i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> is: <span id=equation:portfolio_factor_model></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=double-struck>E</mi><mrow><mo fence=true>[</mo><msub><mi>r</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo fence=true>]</mo></mrow><mo>=</mo><mi mathvariant=double-struck>E</mi><mrow><mo fence=true>[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>r</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo fence=true>]</mo></mrow><mo>=</mo><mi mathvariant=double-struck>E</mi><mrow><mo fence=true>[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>β</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub><msub><mi>y</mi><mrow><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>ϵ</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo fence=true>]</mo></mrow><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>\mathbb{E}\left[r_{a,t}\right] = \mathbb{E}\left[\sum_{i=1}^{I} w_{a,i,t} r_{i,t} \right] = \mathbb{E}\left[\sum_{i=1}^{I} w_{a,i,t} \alpha_i + \sum_{n=1}^{N}\sum_{i=1}^{I} w_{a,i,t}\beta_{i,n} {y}_{n,t} + \sum_{i=1}^{I} w_{a,i,t} \epsilon_{i,t}\right].</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:1.0361em></span><span class="mord mathbb">E</span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0>[</span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>]</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.2777em;height:3.106em></span><span class="mord mathbb">E</span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">[</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size4">]</span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.2777em;height:3.106em></span><span class="mord mathbb">E</span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size4">[</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.0037em>α</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0037em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">ϵ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size4">]</span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord>.</span></span></span></span></span><p>In the model, the residuals <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\epsilon_{i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal">ϵ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> are independent, therefore decreasing the concentration of the allocations <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>w_{a,i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> leads to . Whereas the risk-factor sensitivities <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>β</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\beta_{i,n}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> lead to a dependency on shocks in the risk factor <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span></span></span></span> which aggregates over all holdings in the portfolio, the residuals <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\epsilon_{i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal">ϵ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> vanish in expectation as the weight assigned to any one instrument becomes small, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>→</mo><mn>0</mn></mrow></msub><mi mathvariant=double-struck>E</mi><mrow><mo fence=true>[</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></msubsup><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>ϵ</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo fence=true>]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding=application/x-tex>\lim_{w_{a,i,t}\rightarrow 0} \mathbb{E}\left[\sum_{i=1}^{I} w_{a,i,t} \epsilon_{i,t}\right] = 0</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.65em;height:1.8em></span><span class=mop><span class=mop>lim</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3281em><span style=margin-left:-.0269em;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2819em><span></span></span></span></span></span></span><span class="mrel mtight">→</span><span class="mord mtight">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3473em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbb">E</span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">[</span></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=margin-right:.05em;top:-3.2029em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">ϵ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">]</span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>0</span></span></span></span>. It is expected that when explaining the cross-section of the returns of investment portfolios, the explained variance is at least as good on average as explaining the cross-sectional variance of individual financial instruments. But furthermore, we expect that the explanatory power increases much further, due to diversification.<p>When it comes to the style of a portfolio, it may be useful to think of the portfolio in terms of its mean exposures, as the mean exposure <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mrow><mi>a</mi><mo separator=true>,</mo><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\bar{\beta}_{a,n,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:1.1173em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> times the factor shock <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>y</mi><mrow><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>y_{n,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0359em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> represents the direct contribution of factor <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span></span></span></span> to the returns, at time <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span>. <span id=equation:style_vector></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mrow><mi>a</mi><mo separator=true>,</mo><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>β</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>\bar{\beta}_{a,n,t} = \sum_{i=1}^{I} w_{a,i,t} \beta_{i,n}.</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:1.1173em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.2777em;height:3.106em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord>.</span></span></span></span></span><p>The vector of values <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi>β</mi><mo>ˉ</mo></mover></mrow><annotation encoding=application/x-tex>\bar\beta</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.0257em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span></span></span> for all risk factors <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>N</mi></mrow><annotation encoding=application/x-tex>n=1,2,\ldots,N</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.10903em>N</span></span></span></span> is a simple statistic that is often used to compare portfolios’ investment styles, and hence is called the .<h4 id=section:lipper_model>Lipper Classification Methodology<a title="Permanent link" class=headerlink href=#section:lipper_model></a></h4><p>The <em>Lipper Global Holdings-Based Classification</em>[@1999REFINITIVMethodology] is a system for grouping mutual funds of multiple asset classes. The methodology is broad and covers both equity and fixed income funds, but we focus on the equities portfolios here. The investment style component of the model comprises a scoring scheme taking a moving average with the weighted score of up to 6 recent portfolios, with more weight placed on recent portfolios.<h5 id=reference-index>Reference Index<a title="Permanent link" class=headerlink href=#reference-index></a></h5><p>The Lipper scheme uses the Russel 3000 index as the benchmark index for U.S. equities. The historic index constituents are available as a data product from S&P Global, but the rules for candidates to be included are simple enough that we reconstruct our own reproduction of the index and its historic statistics (Appendix <a href=#appendix:russel3000>A</a>).<h5 id=section:lipper_class_details>Lipper Model Steps<a title="Permanent link" class=headerlink href=#section:lipper_class_details></a></h5><p>Stock market cap size classes are fixed: small, mid, large. The boundaries between these classes are evaluated every June. Large cap stocks are the stocks with the largest market capitalisation that combine to have 40% of the total market capitalisation. The next largest stocks that combine to an additional 30% of the total are the mid cap stocks, and the remainder up to and including the rank-3000 largest stock are the small cap group. Roughly speaking for US equities funds, if a fund’s holdings are at least 75% in one class, they belong to that size class, and otherwise they are labelled as being multi-class.<p>Next, the instruments in the portfolio are scored according to weighted sum of scores on the individual factors. For each factor, the market capitalisation weighted mean <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>μ</mi><mi>b</mi></msub></mrow><annotation encoding=application/x-tex>\mu_{b}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.625em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> and standard deviation <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>σ</mi><mi>b</mi></msub></mrow><annotation encoding=application/x-tex>\sigma_b</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.5806em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0359em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> for the benchmark index are computed.<p>Then, for each portfolio, the allocation-weighted average score <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>μ</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\mu_{a,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> is computed for each factor as the z-score of the portfolio mean to the benchmark index mean and standard deviation, simply <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mrow><msub><mi>μ</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>μ</mi><mi>b</mi></msub></mrow><msub><mi>σ</mi><mi>b</mi></msub></mfrac></mrow><annotation encoding=application/x-tex>\frac{\mu_{a,t}-\mu_{b}}{\sigma_b}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.4509em;height:1.3665em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9157em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.03588em>σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:-.0359em;margin-right:.0714em;top:-2.3488em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1512em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.5073em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2963em><span style=margin-left:0;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2819em><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">μ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.0714em;top:-2.3488em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1512em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.4509em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. When historic portfolios are available, an exponentially weighted moving average according to the weights is given in appendix Table <a href=#equation:lipper_style>1.1</a>.<p>The style score is then the sum of the scores on individual factors. The first three factors contribute towards the instrument counting as a growth stock, the latter three factors are associated with value investments. Each factor is sub-scripted to indicate these are computed according to the Lipper specification, as other variants may appear elsewhere in the text.<table><thead><tr><th><strong>Weight</strong><th><strong>Factor</strong><th><strong>Compustat Variables</strong><tbody><tr><td>+1<td>price-to-earnings<td><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mrow><mi mathvariant=normal>E</mi><mi mathvariant=normal>P</mi><mi mathvariant=normal>S</mi><mi mathvariant=normal>F</mi><mi mathvariant=normal>I</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>P</mi><mi mathvariant=normal>R</mi><mi mathvariant=normal>C</mi><mi mathvariant=normal>C</mi></mrow></mrow><annotation encoding=application/x-tex>\mathrm{EPSFI}, \mathrm{PRCC}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord><span class="mord mathrm">EPSFI</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">PRCC</span></span></span></span></span><tr><td>+1<td>price-to-book<td><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mrow><mi mathvariant=normal>C</mi><mi mathvariant=normal>E</mi><mi mathvariant=normal>Q</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>C</mi><mi mathvariant=normal>S</mi><mi mathvariant=normal>H</mi><mi mathvariant=normal>O</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>P</mi><mi mathvariant=normal>R</mi><mi mathvariant=normal>C</mi><mi mathvariant=normal>C</mi></mrow></mrow><annotation encoding=application/x-tex>\mathrm{CEQ}, \mathrm{CSHO}, \mathrm{PRCC}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord><span class="mord mathrm">CEQ</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">CSHO</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">PRCC</span></span></span></span></span><tr><td>+1<td>price-to-sales<td><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mrow><mi mathvariant=normal>S</mi><mi mathvariant=normal>A</mi><mi mathvariant=normal>L</mi><mi mathvariant=normal>E</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>C</mi><mi mathvariant=normal>S</mi><mi mathvariant=normal>H</mi><mi mathvariant=normal>O</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>P</mi><mi mathvariant=normal>R</mi><mi mathvariant=normal>C</mi><mi mathvariant=normal>C</mi></mrow></mrow><annotation encoding=application/x-tex>\mathrm{SALE}, \mathrm{CSHO}, \mathrm{PRCC}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord><span class="mord mathrm">SALE</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">CSHO</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">PRCC</span></span></span></span></span><tr><td>-1<td>return on equity<td><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mrow><mi mathvariant=normal>N</mi><mi mathvariant=normal>I</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>C</mi><mi mathvariant=normal>E</mi><mi mathvariant=normal>Q</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>P</mi><mi mathvariant=normal>R</mi><mi mathvariant=normal>C</mi><mi mathvariant=normal>C</mi></mrow></mrow><annotation encoding=application/x-tex>\mathrm{NI}, \mathrm{CEQ}, \mathrm{PRCC}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord><span class="mord mathrm">NI</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">CEQ</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">PRCC</span></span></span></span></span><tr><td>-1<td>dividend yield<td><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mrow><mi mathvariant=normal>D</mi><mi mathvariant=normal>V</mi><mi mathvariant=normal>P</mi><mi mathvariant=normal>S</mi><mi mathvariant=normal>X</mi></mrow><mo separator=true>,</mo><mrow><mi mathvariant=normal>P</mi><mi mathvariant=normal>R</mi><mi mathvariant=normal>C</mi><mi mathvariant=normal>C</mi></mrow></mrow><annotation encoding=application/x-tex>\mathrm{DVPSX},\mathrm{PRCC }</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord><span class="mord mathrm">DVPSX</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathrm">PRCC</span></span></span></span></span><tr><td>-1<td>3-year earnings growth<td><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>N</mi><mi mathvariant=normal>I</mi></mrow><annotation encoding=application/x-tex>\mathrm{NI}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6833em></span><span class=mord><span class="mord mathrm">NI</span></span></span></span></span></table><dl><dd>This table lists the six variables in the Lipper Style Score model, and the Compustat variables used to compute them.</dl><p>The scores are computed for all the instruments in the benchmark index and instruments that are not in the index but that appear in the holdings of the portfolios alike. Later in this chapter we will give the models the most recent and older portfolios to learn from. Therefore it is not necessary to compute the weighted moving time average, as even the linear models should be able to learn a weighting scheme of current and historical values.<h3 id=section:strategy_overview_leverage>Leverage Ratio<a title="Permanent link" class=headerlink href=#section:strategy_overview_leverage></a></h3><p>The is defined as the ratio of risky instruments to the net asset value <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>W</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>W_{a,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.1389em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span>.<p>The choice which instruments are considered risky and which are safe depend on the firm and the jurisdiction they operate in. Usually, these instruments are cash (currency) or sometimes high-quality (government) bonds are included.<p>Therefore, in our most general specification we define a set <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>S</mi><mo>⊂</mo><mi mathvariant=script>I</mi></mrow><annotation encoding=application/x-tex>\mathcal{S} \subset \mathcal{I}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.0391em;height:.7224em></span><span class="mord mathcal" style=margin-right:.075em>S</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>⊂</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6833em></span><span class="mord mathcal" style=margin-right:.07382em>I</span></span></span></span> of safe instruments. As we continue our focus on US investment funds, in practice, this set contains only US Dollar cash, short-dated US-government securities such as treasury bills, and any amount participating in money market funds. The relationship between the allocation fraction, leverage ratio and portfolio net value is: <span id=equation:bookkeeping_equation></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>λ</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi mathvariant=script>I</mi><mi mathvariant=normal>\</mi><mi mathvariant=script>S</mi></mrow></munder><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi mathvariant=script>I</mi><mi mathvariant=normal>\</mi><mi mathvariant=script>S</mi></mrow></munder><msub><mi>S</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>p</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><msub><mi>W</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mfrac></mrow><annotation encoding=application/x-tex>\lambda_{a,t} = \sum_{i\in\mathcal{I} \backslash \mathcal{S}} w_{a,i,t} = \frac{\sum_{i\in\mathcal{I} \backslash \mathcal{S}} S_{a,i,t}p_{i,t}}{W_{a,t}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.516em;height:2.566em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.05em><span style=margin-left:0;top:-1.809em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style=margin-right:.07382em>I</span><span class="mord mtight">\</span><span class="mord mathcal mtight" style=margin-right:.075em>S</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.516em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.9721em;height:2.5868em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.6147em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.1389em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.8647em><span class=pstrut style=height:3em></span><span class=mord><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2253em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style=margin-right:.07382em>I</span><span class="mord mtight">\</span><span class="mord mathcal mtight" style=margin-right:.075em>S</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.4747em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9721em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>In the case of Form 13F we do not have all balance sheet items available. As in many reports the allocation weights are omitted and the total asset value is not stated, we do not know the leverage ratio, and we must assume that the leverage ratio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>λ</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>\lambda_{a,t} = 1</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord mathnormal">λ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>1</span></span></span></span>. This is not the case for Form N, and specifically Form is highly detailed: not only are all accounting values mandatory, we also get a breakdown of assets considered to be part of the safe assets <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=script>S</mi></mrow><annotation encoding=application/x-tex>\mathcal{S}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6833em></span><span class="mord mathcal" style=margin-right:.075em>S</span></span></span></span>.<h3 id=section:portfolio_optimisation>Portfolio Optimisation<a title="Permanent link" class=headerlink href=#section:portfolio_optimisation></a></h3><p>While the factor projections of portfolios suggest that managers often coordinate on stable combinations of risk exposures, this is not enough to explain all portfolio weights in the data. This is clear from inspecting the portfolios of various funds for which we have reliable style classifications aligned with the stated objective in the prospectus: it is clear that for many funds there are cases where a monotonic preference relationship between risk-factor exposure, market capitalisation, and the allocation weight in the portfolio is violated. This indicates that portfolios are further shaped by processes beyond the constraint on a certain investment style.<p>In the literature, the focus is often on expected returns (the first moment) and return volatility (the square root of the second central moment). As discussed in Chapter <a href=#chapter:return_attribution>3</a>, under the assumption of market efficiency (Appendix <a href=#appendix:factor_models>A</a>), the market reflects a single price for a unit of volatility. This does not preclude heterogeneity in the preferences of investors when it comes to the reward-risk trade off.<p>The foundational work of Markowitz [@Markowitz1952] introduced the framework for portfolio optimisation by balancing expected returns against risk, where risk is quantified as portfolio variance. This approach forms the basis of modern portfolio theory and later inspired Sharpe’s [capm]{acronym-label=”capm” acronym-form=”singular+short”} [@Sharpe], which further formalized the relationship between expected returns and market risk through the concept of the market price of risk.<p>A common optimisation goal in this framework is to maximise a utility function that incorporates both return and risk, parametrised by a risk-aversion factor <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>γ</mi></mrow><annotation encoding=application/x-tex>\gamma</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.625em></span><span class="mord mathnormal" style=margin-right:.05556em>γ</span></span></span></span> <span id=equation:sharpe_optimisation></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></munder><mfrac><mrow><mi mathvariant=double-struck>E</mi><mrow><mo fence=true>[</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>r</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo fence=true>]</mo></mrow><mo>−</mo><mi>γ</mi></mrow><msqrt><mrow><mtext>Var</mtext><mrow><mo fence=true>[</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><msub><mi>r</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo fence=true>]</mo></mrow></mrow></msqrt></mfrac><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\max_{w_{a,i,t}} \frac{\mathbb{E}\left[\sum_i w_{a,i,t} r_{i,t}\right] - \gamma}{\sqrt{\text{Var}\left[\sum_i w_{a,i,t} r_{i,t}\right]}},</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-1.13em;height:2.5697em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.4306em><span style=margin-left:0;top:-2.4em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3281em><span style=margin-left:-.0269em;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2819em><span></span></span></span></span></span></span></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span><span class=mop>max</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.8973em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.4397em><span style=top:-2.1999em><span class=pstrut style=height:3em></span><span class=mord><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9101em><span class=svg-align style=top:-3.2em><span class=pstrut style=height:3.2em></span><span class=mord style=padding-left:1em><span class="mord text"><span class=mord>Var</span></span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0>[</span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.162em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>]</span></span></span></span><span style=top:-2.8701em><span class=pstrut style=height:3.2em></span><span class=hide-tail style=min-width:1.02em;height:1.28em><svg preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1296" height=1.28em width=400em xmlns=http://www.w3.org/2000/svg><path d="M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3299em><span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.6897em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathbb">E</span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0>[</span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.162em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>]</span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class="mord mathnormal" style=margin-right:.05556em>γ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.13em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct>,</span></span></span></span></span><p>Where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>w_{a,i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> represents the weight of asset <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> in portfolio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span> at time <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span>, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>r_{i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> is the return of asset <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> at time <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span>. This equation generalises Sharpe ratio maximisation and incorporates flexibility for varying risk preferences. Figure <a href=#diagram:markowitz_optimisation_theory>1.3</a> illustrates these concepts: the curved arcs represent all portfolios that are optimal in terms of <a href=#equation:sharpe_optimisation>this equation</a> for different choices of risk-aversion <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>γ</mi></mrow><annotation encoding=application/x-tex>\gamma</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.625em></span><span class="mord mathnormal" style=margin-right:.05556em>γ</span></span></span></span>. These curves as parametrised by <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>γ</mi></mrow><annotation encoding=application/x-tex>\gamma</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.625em></span><span class="mord mathnormal" style=margin-right:.05556em>γ</span></span></span></span> are called the . In this diagram, we observe two frontiers: one efficient frontier for portfolios on all possible instruments in the market where the style of the portfolio is unconstrained, and one for all portfolios that satisfy the style constraint. The diagram illustrates that the constraint of having the mean portfolio exposures <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi>β</mi><mo>ˉ</mo></mover></mrow><annotation encoding=application/x-tex>\bar\beta</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.0257em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span></span></span> near a target style, makes the set of valid portfolios smaller, and makes it likely that constrained portfolios have lower expected returns or higher volatility than unconstrained optimised portfolios, or both.<p>In the confines of the Markowitz framework, speciation or the constraint to a certain investment style, thus seems irrational, as a wider investment universe likely permits optimised portfolio combinations with higher expected return, lower expected volatility, or both, with the exception of the case where the stock portfolio constrained to a certain risk exposure serves to offset risks the investor is exposed to in other types of investments or income streams.<figure id=diagram:markowitz_optimisation_theory><img src=/images/diagram_gan.png><figcaption>This diagram displays the Markowitz optimisation model for a hypothetical case, where the reference portfolio has a backtest volatility of 20% and an expected arithmetic return of 4%.</figcaption></figure><p>As came up in the investigation of factor model optimality in Chapter <a href=#chapter:return_attribution>3</a>, Section <a href=#section:residual_alpha_information_criterion>[section:residual_alpha_information_criterion]</a>, a condition for optimality of a portfolio is that the joint alphas defined as the idiosyncratic returns of all assets relative to the portfolio are zero [@Gibbons1989APortfolio]. However, testing this in practice is challenging due to the low statistical power of such tests in limited datasets, where estimation errors for variances and covariances can dominate. Furthermore, real-world instruments often exhibit significant idiosyncratic returns, reflecting deviations from market efficiency caused by transaction costs, liquidity constraints, or behavioural biases. Some fund managers also demonstrate persistence in returns [@Carhart1997OnPerformance], suggesting that alphas may not always align with theoretical expectations. Given these challenges, we choose not to perform these tests directly. Instead, we adopt a more general optimisation test that allows for the inclusion of additional constraints in this chapter in Section <a href=#section:markowitz_optimality_experiment>1.3.3</a>.<h3 id=section:turnover_rate_analysis>Turnover Rate<a title="Permanent link" class=headerlink href=#section:turnover_rate_analysis></a></h3><p>As discussed in preceding Sections <a href=#equation:portfolio_exposure_models>1.2.3</a>-<a href=#section:portfolio_optimisation>1.2.5</a>, the dynamics of both the underlying economic variables and those of market prices themselves cause the portfolio to drift away from the desired allocation. Thus a manager may need to actively intervene by trading the instruments in the portfolio.<p>We adopt the absolute turnover metric (<a href=#equation:portfolio_turnover>this equation</a>) to quantify portfolio trading activity because it captures the volume of capital reallocated through buying and selling, normalised by the portfolio’s net value. This measure is particularly suited for evaluating operational costs and market impact, as these arise from any trading activity, regardless of its purpose. Unlike metrics that focus solely on relative changes in portfolio composition (See a discussion in Appendix <a href=#section:portfolio_turnover_deep_dive>A</a>), absolute turnover also accounts for trading driven by fund flows, such as investor deposits or withdrawals, which can represent a significant fraction of overall trading activity. By including all sources of trading, absolute turnover provides a practical assessment of the trading intensity associated with the strategy. Additionally, normalising by the portfolio’s net value ensures comparability across portfolios of different sizes.<p>The turnover is defined as: <span id=equation:portfolio_turnover></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mrow><mi mathvariant=normal>t</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>n</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>v</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>r</mi></mrow><mi>a</mi><mtext>absolute</mtext></msubsup><mrow><mo fence=true>(</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo fence=true>)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mn>1</mn></msub><mo lspace=0em rspace=0em>+</mo><mn>1</mn></mrow><msub><mi>t</mi><mn>2</mn></msub></munderover><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><mfrac><mrow><mo fence=true>∣</mo><mrow><mo fence=true>(</mo><msub><mi>S</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>S</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>i</mi><mo separator=true>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo fence=true>)</mo></mrow><msub><mi>p</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow></msub><mo fence=true>∣</mo></mrow><mrow><mn>2</mn><mtext> </mtext><mi>δ</mi><mo stretchy=false>(</mo><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn><mo separator=true>,</mo><mtext> </mtext><mi>t</mi><mo stretchy=false>)</mo><mtext> </mtext><msub><mi>W</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>\mathrm{turnover}^{\text{absolute}}_{a}\left(t_1, t_2\right) = \sum_{t=t_1{+}1}^{t_2} \sum_{i=1}^{{I}} \frac{\left| \left(S_{a,i,t} - S_{a,i,t-1}\right) p_{i,t{-}1}\right|}{2~\delta(t{-}1, ~t)~W_{a,t{-}1}}.</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1.1491em></span><span class=mord><span class=mord><span class="mord mathrm">turnover</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8991em><span style=margin-right:.05em;top:-2.453em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span style=margin-right:.05em;top:-3.113em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">absolute</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.3672em;height:3.1955em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.7917em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3173em><span style=margin-left:0;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mtight">+</span></span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3111em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3173em><span style=margin-left:0;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.3672em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.427em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>2</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style=margin-right:.03785em>δ</span><span class=mopen>(</span><span class="mord mathnormal">t</span><span class=mord><span class=mord>−</span></span><span class=mord>1</span><span class=mpunct>,</span><span class="mspace nobreak"> </span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">t</span><span class=mclose>)</span><span class="mspace nobreak"> </span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>W</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.1389em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=minner><span class="mopen delimcenter" style=top:0>∣</span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>∣</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9721em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord>.</span></span></span></span></span><p>In this definition, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>t</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>t_1, t_2</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8095em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> are two points in time at which the positions <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>S</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>S_a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8333em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05764em>S</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:-.0576em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> of the portfolio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span> are observed, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>δ</mi><mo stretchy=false>(</mo><msub><mi>t</mi><mn>1</mn></msub><mo separator=true>,</mo><msub><mi>t</mi><mn>1</mn></msub><mo lspace=0em rspace=0em>+</mo><mn>1</mn><mo stretchy=false>)</mo><mo separator=true>,</mo><mi>δ</mi><mo stretchy=false>(</mo><msub><mi>t</mi><mn>1</mn></msub><mo lspace=0em rspace=0em>+</mo><mn>1</mn><mo separator=true>,</mo><msub><mi>t</mi><mn>1</mn></msub><mo lspace=0em rspace=0em>+</mo><mn>2</mn><mo stretchy=false>)</mo><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>δ</mi><mo stretchy=false>(</mo><msub><mi>t</mi><mn>2</mn></msub><mo lspace=0em rspace=0em>−</mo><mn>1</mn><mo separator=true>,</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\delta(t_1, t_1{+}1), \delta(t_1{+}1, t_1{+}2),\ldots,\delta(t_2{-}1, t_2)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class="mord mathnormal" style=margin-right:.03785em>δ</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class=mord>+</span></span><span class=mord>1</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03785em>δ</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class=mord>+</span></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class=mord>+</span></span><span class=mord>2</span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.03785em>δ</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord><span class=mord>−</span></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">t</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> are the year fractions used to annualise turnover rates. The constant two appears in the denominator as a full turnover cycle of the portfolio is defined as the building up of a position and winding it down, thus leading to twice the observed trading quantity.<h2 id=experiments>Experiments<a title="Permanent link" class=headerlink href=#experiments></a></h2><p>In this section we detail the initial experiments investigating classification stability (Section <a href=#section:classifier_stability>1.3.2</a>), portfolio optimisation (Section <a href=#section:portfolio_optimisation>1.2.5</a>) and<h3 id=section:comparison_with_lipper>Model Alignment<a title="Permanent link" class=headerlink href=#section:comparison_with_lipper></a></h3><p>In this section, we perform the model alignment and comparison with the Lipper methodology focusing on the investment styles. We first need to make the model comparable, by putting them in same coordinate<h4 id=section:procrustes_analysis>Procrustes Analysis<a title="Permanent link" class=headerlink href=#section:procrustes_analysis></a></h4><p>In order to be able to compare the latent factors uncovered by our neural network and the explicit factors of the Lipper methodology, we need to align the spaces these methods span. Specifically, we want that the average factor loadings of portfolios grouped by Lipper class is aligned with the average of the same portfolios<p>A family of methods called Procrustes analysis offers the tools to perform this alignment (a comprehensive summary can be found in [@Gower2004ProcrustesProblems]). In our case, we are looking for a transformation matrix <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>R</mi></mrow><annotation encoding=application/x-tex>\mathbf{R}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6861em></span><span class="mord mathbf">R</span></span></span></span> such that the dot product of the factor model is maintained, essentially meaning that our prediction of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>r_{i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> is not affected by the transformation of the latent variables:<p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>r</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>β</mi><mrow><mi>i</mi><mo separator=true>,</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>k</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>t</mi></mrow></mrow></msub><msub><mi>y</mi><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>k</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>t</mi></mrow></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=false>(</mo><mi mathvariant=bold>R</mi><mi>β</mi><msub><mo stretchy=false>)</mo><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub><mo stretchy=false>(</mo><mi mathvariant=bold>R</mi><mi>y</mi><msub><mo stretchy=false>)</mo><mrow><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>r_{i,t} = \alpha_i + \beta_{i,\mathrm{market}}y_{\mathrm{market}} + \sum_{n=1}^{N} (\mathbf{R} \beta)_{i,n} (\mathbf{R} y)_{n,t}.</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.7167em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.15em;height:.7333em></span><span class=mord><span class="mord mathnormal" style=margin-right:.0037em>α</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0037em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathrm mtight">market</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0359em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">market</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-1.2671em;height:3.0954em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathbf">R</span><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord mathbf">R</span><span class="mord mathnormal" style=margin-right:.03588em>y</span><span class=mclose><span class=mclose>)</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord>.</span></span></span></span></span><p>This is known as the orthogonal procrustes problem [@Schonemann1966AProblem] and can be solved by making <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>R</mi></mrow><annotation encoding=application/x-tex>\mathbf{R}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6861em></span><span class="mord mathbf">R</span></span></span></span> an orthogonal rotation matrix, meaning solutions have <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>R</mi><msup><mi mathvariant=bold>R</mi><mi>T</mi></msup><mo>=</mo><mn mathvariant=bold>1</mn></mrow><annotation encoding=application/x-tex>\mathbf{R}\mathbf{R}^T = \mathbf{1}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.8413em></span><span class="mord mathbf">R</span><span class=mord><span class="mord mathbf">R</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=margin-right:.05em;top:-3.063em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.13889em>T</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class="mord mathbf">1</span></span></span></span>. For all Lipper labels <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>L</mi></mrow><annotation encoding=application/x-tex>L</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">L</span></span></span></span>, we take a set of portfolios that are observed over the entire period so that the statistics aren’t influenced by portfolios coming in to the sample and leaving. We compute the mean exposure for each label <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mi>t</mi><mi>L</mi></msubsup></mrow><annotation encoding=application/x-tex>\bar\beta_{t}^{L}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.247em;height:1.0883em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8413em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.453em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style=margin-right:.05em;top:-3.063em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span></span></span></span>. Next, want to minimise the distance of the time difference:<p><span id=equtioon:procrustes_optimisation_problem></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant=bold>R</mi></munder><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><msubsup><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mi>t</mi><mi>L</mi></msubsup><mi mathvariant=bold>R</mi><mo>−</mo><msubsup><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow><mi>L</mi></msubsup><mi mathvariant=normal>∣</mi><msubsup><mi mathvariant=normal>∣</mi><mi>F</mi><mn>2</mn></msubsup><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\min_{\mathbf{R}} || \bar\beta_{t}^{L} \mathbf{R} - \bar\beta_{t{-}1}^{L} ||_F^2,</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.7463em;height:1.6376em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6679em><span style=margin-left:0;top:-2.3537em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">R</span></span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span><span class=mop>min</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.7463em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord>∣∣</span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8913em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.453em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style=margin-right:.05em;top:-3.113em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class="mord mathbf">R</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.3053em;height:1.1967em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8913em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.453em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">1</span></span></span></span><span style=margin-right:.05em;top:-3.113em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3053em><span></span></span></span></span></span></span><span class=mord>∣</span><span class=mord><span class=mord>∣</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8641em><span style=margin-left:0;margin-right:.05em;top:-2.453em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.13889em>F</span></span></span><span style=margin-right:.05em;top:-3.113em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.247em><span></span></span></span></span></span></span><span class=mpunct>,</span></span></span></span></span><p>where the Frobenius-norm squared means we are minimising the sum of all elements squared. [@Schonemann1966AProblem] showed that taking the singular value decomposition of the product of the means of each label <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>U</mi><mi mathvariant=bold>Σ</mi><msup><mi mathvariant=bold>V</mi><mi>T</mi></msup><mo>=</mo><mrow><mi mathvariant=normal>S</mi><mi mathvariant=normal>V</mi><mi mathvariant=normal>D</mi></mrow><mo stretchy=false>(</mo><msub><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo>−</mo><msub><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\mathbf{U} \mathbf{\Sigma} \mathbf{V}^T=\mathrm{SVD}(\bar\beta_t - \bar\beta_{t-1})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.8413em></span><span class="mord mathbf">UΣ</span><span class=mord><span class="mord mathbf" style=margin-right:.01597em>V</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=margin-right:.05em;top:-3.063em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.13889em>T</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.25em;height:1.0812em></span><span class=mord><span class="mord mathrm">SVD</span></span><span class=mopen>(</span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.25em;height:1.0812em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2083em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> gives the solution <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>R</mi><mo>=</mo><mi mathvariant=bold>U</mi><msup><mi mathvariant=bold>V</mi><mi>T</mi></msup></mrow><annotation encoding=application/x-tex>\mathbf{R} = \mathbf{U} \mathbf{V}^T</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6861em></span><span class="mord mathbf">R</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.8413em></span><span class="mord mathbf">U</span><span class=mord><span class="mord mathbf" style=margin-right:.01597em>V</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8413em><span style=margin-right:.05em;top:-3.063em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.13889em>T</span></span></span></span></span></span></span></span></span></span></span>.<h4 id=section:model_equivalence_testing>Model Equivalence Testing<a title="Permanent link" class=headerlink href=#section:model_equivalence_testing></a></h4><p>We move ahead with the projection of the portfolios onto the factors that we found when explaining the cross-section of the returns of US equities, aligned by For all funds in our data where we have computed an average factor loading <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi>β</mi><mo>ˉ</mo></mover></mrow><annotation encoding=application/x-tex>\bar\beta</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.0257em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span></span></span>, we have Lipper classifications. We focus on investment style aspect of the classification, and take the Growth and Value orientation of the funds. We perform the following test to see whether our factor model is aligned with the Lipper classification scheme.<p>To test the compatibility of our factor model with the Lipper classification, we assign class labels of +1 for Growth, -1 for Value, and 0 for Core funds. Factor loadings <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mo>=</mo><mo stretchy=false>(</mo><msub><mi>β</mi><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>k</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>t</mi></mrow></msub><mo separator=true>,</mo><msub><mi>β</mi><mn>1</mn></msub><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><msub><mi>β</mi><mn>6</mn></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\bar\beta = (\beta_{\mathrm{market}}, \beta_1, \ldots, \beta_6)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.0257em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">market</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span> are used as input features for a Support Vector Machine (SVM) to find linear decision boundaries.<p>The data is split into training and test sets, with 50% reserved for each. Results are summarised in Table <a href=#table:classification_summary>1.2</a>. The first panel shows performance for Growth and Value styles, and the second includes the Core class. Between Growth and Value, classification accuracy is 97.3%. Including Core reduces performance due to greater overlap in factor space, suggesting a more complex structure in the latent space that the linear SVM cannot fully capture.<table><thead><tr><th><strong>Panel A: Growth vs. Value</strong><th>Accuracy<th>Recall<th>F1 Score<tbody><tr><td><strong>Value</strong><td>0.984<td>0.973<td>0.978<tr><td><strong>Growth</strong><td>0.955<td>0.974<td>0.964<tr><td><strong>Average</strong><td><strong>0.973</strong><td><strong>0.973</strong><td><strong>0.973</strong></table><table><thead><tr><th><strong>Panel B: Growth, Value, Core</strong><th>Accuracy<th>Recall<th>F1 Score<tbody><tr><td><strong>Value</strong><td>0.817<td>0.868<td>0.842<tr><td><strong>Core</strong><td>0.746<td>0.688<td>0.716<tr><td><strong>Growth</strong><td>0.923<td>0.876<td>0.898<tr><td><strong>Average</strong><td><strong>0.838</strong><td><strong>0.837</strong><td><strong>0.837</strong></table><dl><dd>SVM classification performance linking factor model classifications to Lipper’s investment styles. Panel A reports results for Growth and Value styles only. Panel B includes Core styles.</dl><p>We observe that when it comes to the three typical categories relating to style, obtain an approximate 83.8% commonality, as read from Table <a href=#table:classification_summary>1.2</a> for the accuracy of the three-label variant in Panel B. On average there is 16.2% discrepancy, which is close to the discrepancy reported in the literature when using different factor models as the ground truth, such as the Carhart model [@Bams2017InvestmentPerformance].<h4 id=diversity-of-risk-factors>Diversity of Risk Factors<a title="Permanent link" class=headerlink href=#diversity-of-risk-factors></a></h4><p>Do fund managers have subjective ideas about what constitutes a certain investment style? We investigate pairs of funds that share the same management company. For all management firms that manage both a value and growth fund on the same universe, we compute the difference: <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>b</mi><mo>⃗</mo></mover><mi>a</mi></msub><mo>=</mo><msub><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mrow><mtext>value</mtext><mo separator=true>,</mo><mi>n</mi><mo separator=true>,</mo></mrow></msub><mo>−</mo><msub><mover accent=true><mi>β</mi><mo>ˉ</mo></mover><mrow><mtext>growth</mtext><mo separator=true>,</mo><mi>n</mi><mo separator=true>,</mo></mrow></msub><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\vec{b}_{a} = \bar\beta_{\text{value}, n, } - \bar\beta_{\text{growth}, n, },</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:1.1274em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9774em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">b</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2355em><span class=overlay style=width:.471em;height:.714em><svg viewbox="0 0 471 714" height=0.714em preserveaspectratio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5 3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11 10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63 -1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1 -7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59 H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359 c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.2861em;height:1.1173em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">value</span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.2861em;height:1.1173em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">growth</span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mpunct>,</span></span></span></span></span><p>where <em>value</em>, <em>growth</em> are the portfolios of fund manager <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi>β</mi><mo>ˉ</mo></mover></mrow><annotation encoding=application/x-tex>\bar\beta</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.0257em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8312em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>ˉ</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span></span></span> are the portfolio average exposures to risk factor <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span></span></span></span>.<p>We expect that if all managers follow the same interpretation of the risk factors, then the vectors <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi>b</mi><mo>⃗</mo></mover></mrow><annotation encoding=application/x-tex>\vec{b}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.9774em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9774em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">b</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2355em><span class=overlay style=width:.471em;height:.714em><svg viewbox="0 0 471 714" height=0.714em preserveaspectratio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5 3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11 10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63 -1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1 -7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59 H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359 c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span></span></span> all point in the same direction. We can efficiently test this by taking the mean vector <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mover accent=true><mi>b</mi><mo>⃗</mo></mover><mo>ˉ</mo></mover></mrow><annotation encoding=application/x-tex>\bar{\vec{b}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:1.1142em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.1142em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9774em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">b</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2355em><span class=overlay style=width:.471em;height:.714em><svg viewbox="0 0 471 714" height=0.714em preserveaspectratio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5 3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11 10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63 -1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1 -7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59 H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359 c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span></span></span></span></span><span style=top:-3.5464em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.25em><span class=mord>ˉ</span></span></span></span></span></span></span></span></span></span> over all managers, and computing the cosine similarity between individual manager’s vectors and the population mean. We expect that this is especially the cases for the risk factors that show a clear and steady separation between the means of the different classes as demonstrated in Section <a href=#section:procrustes_analysis>1.3.1.1</a>. This is not the case in aggregate: only the risk factor that receive the highest importance in the factor model have positive cosine similarity for all managers. There, the average cosine similarity to the population average is 0.599, indicating high similarity in the beliefs management firms have about the orientation of an investment style in factor space. When other risk factors are included such as the market factor, 42.2% of managers in fact have a negative cosine similarity, indicating high diversity among the other risk factors.<h3 id=section:classifier_stability>Stability<a title="Permanent link" class=headerlink href=#section:classifier_stability></a></h3><p>Do fund managers target specific factor loadings that we can learn using the machine learning methodology we discussed in this chapter? If the fund managers don’t target specific loadings, or we fail to learn the appropriate model in the unsupervised learning, then we expect that loadings evolve with a stability as best as good as a process trading with the same turnover rate.<p>To measure the stability of portfolios in the latent space over time, we define the distance between consecutive classifications as the drift. Then, the average rate of drift through the latent space for either the factor model or the null model are defined as<p><span id=equation:style_drift_rate></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>u</mi><mi>a</mi></msub><mo stretchy=false>(</mo><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>l</mi></mrow><mi mathvariant=normal>∣</mi><mrow><mi mathvariant=normal>n</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>l</mi><mi mathvariant=normal>l</mi></mrow><mo stretchy=false>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow><mo fence=true>∣</mo><msub><mi>β</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>β</mi><mrow><mi>a</mi><mo separator=true>,</mo><mi>n</mi><mo separator=true>,</mo><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow></msub><mo fence=true>∣</mo></mrow></mrow><annotation encoding=application/x-tex>u_{a}( \mathrm{model}|\mathrm{null}) = \frac{1}{T}\sum_{t=1}^{T} \sum_{n=1}^{N} \left|\beta_{a,n,t} - \beta_{a,n,t{-}1}\right|</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class=mord><span class="mord mathnormal">u</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class="mord mathrm">model</span></span><span class=mord>∣</span><span class=mord><span class="mord mathrm">null</span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.2671em;height:3.0954em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.3214em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal" style=margin-right:.13889em>T</span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.686em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.1667em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.13889em>T</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0>∣</span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>∣</span></span></span></span></span></span><p>We devise a null-model hypothesis test with a null hypothesis stating that investment funds maintain their risk exposures no better than a comparable portfolio traded randomly under our measure, and the alternative hypothesis:<p><span id=equation:null_and_alternative_hypothesis></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mtable columnalign="right left" columnspacing=0em rowspacing=0.25em><mtr><mtd><mstyle displaystyle=true scriptlevel=0><msub><mi>H</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>:</mo><mi>u</mi><mo stretchy=false>(</mo><msub><mi>X</mi><mtext>null</mtext></msub><mo stretchy=false>)</mo><mo>≤</mo><mi>u</mi><mo stretchy=false>(</mo><msub><mi>X</mi><mtext>model</mtext></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=true scriptlevel=0><msub><mi>H</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle displaystyle=true scriptlevel=0><mrow><mrow></mrow><mo>:</mo><mi>u</mi><mo stretchy=false>(</mo><msub><mi>X</mi><mtext>null</mtext></msub><mo stretchy=false>)</mo><mo>></mo><mi>u</mi><mo stretchy=false>(</mo><msub><mi>X</mi><mtext>model</mtext></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\begin{aligned} H_0 &: u(X_{\text{null}}) \leq u(X_{\text{model}}) \\ H_1 &: u(X_{\text{null}}) > u(X_{\text{model}}) \end{aligned}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-1.25em;height:3em></span><span class=mord><span class=mtable><span class=col-align-r><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.75em><span style=top:-3.91em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.08125em>H</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0813em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-2.41em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.08125em>H</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0813em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.25em><span></span></span></span></span></span><span class=col-align-l><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.75em><span style=top:-3.91em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">u</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0785em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">null</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">u</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0785em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span><span style=top:-2.41em><span class=pstrut style=height:3em></span><span class=mord><span class=mord></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>:</span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">u</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0785em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">null</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span><span class="mord mathnormal">u</span><span class=mopen>(</span><span class=mord><span class="mord mathnormal" style=margin-right:.07847em>X</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0785em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">model</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.25em><span></span></span></span></span></span></span></span></span></span></span></span><p>In comparison, we compute the same distance over the random null-model portfolios generated from the same initial portfolio. Here, we use the mean 10 Monte-Carlo samples from the null model to estimate the drift under this model of random trading. We then compare this for portfolios of funds active in January 2020, whose factor exposures and turnover rates are estimated on the preceding five years. The results are summarised in Section <a href=#section:analysis_stability>1.4.1</a>.<h3 id=section:markowitz_optimality_experiment>Markowitz-Optimality<a title="Permanent link" class=headerlink href=#section:markowitz_optimality_experiment></a></h3><p>There is some difficulty in determining which exact constraints may have been imposed in allocating the portfolio. Multiple constraints can lead to the same solution, making the underlying optimisation problem non-unique. To simplify the analysis, we first assume constraints on allocation weights, excluding leverage and short selling. These assumptions remove additional degrees of freedom, narrowing our focus to the observable risk-reward trade-off in the portfolio.<p>We also assume that the eligible universe of stocks for the portfolio consists of those the portfolio has invested in, with other stocks filtered out earlier in the investment process. Under these assumptions, portfolios that lie on the efficient frontier for their respective universes of stocks would represent cases where Markowitz optimisation is applied without additional constraints.<p>To test this, we construct an efficient frontier for portfolios with the same mean factor loadings as the portfolio under review. In practice, however, market frictions such as reaction times, transaction costs, and turnover constraints make it difficult for portfolio managers to maintain perfectly optimised portfolios. These factors mean that portfolios are often observed at some distance from their theoretical optimisation targets. We compute the distance to the frontier in terms of a Sharpe ratio, since this is the most commonly used metric to describe a mutual fund’s performance.<p>We investigate the extent to which portfolios align with the Markowitz ideal or represent plausible factor-themed portfolios that are mean-variance optimised. Rather than relying on subjective models of future returns, we evaluate portfolios based on their performance in historical back-tests, comparing them to randomly sampled portfolios with similar factor characteristics. Section <a href=#section:markowitz_optimality_null_model>1.3.3.1</a> explains how the null model is constructed, and Appendix <a href=#section:portfolio_optimisation_null_model>A</a> details how to sample from it.<h4 id=section:markowitz_optimality_null_model>Null-Hypothesis<a title="Permanent link" class=headerlink href=#section:markowitz_optimality_null_model></a></h4><p>The null hypothesis states that the portfolio is not mean-variance optimised an instead arises from a probabilistic null model. For this, we construct and sample from a null model that selects stocks with probability proportional to the market capitalisation. The null model will be drawn from all possible allocations over the same stocks, with the constraint that the mean factor exposure of the null model does not deviate by more than 10% for each factor. We then sample <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>M</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding=application/x-tex>M=100</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal" style=margin-right:.10903em>M</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>100</span></span></span></span> such portfolios and compute their Sharpe ratios. A portfolio is deemed optimised if its Sharpe ratio is at least as high as 99% of the randomly sampled portfolios.<h3 id=section:learning_to_invest>Learning to Allocate a Portfolio<a title="Permanent link" class=headerlink href=#section:learning_to_invest></a></h3><p>The preceding investigations give rise to a general form of understanding portfolio management: fund managers’ portfolio behaviours cannot be fully captured by simple averages of risk factor exposures. Some managers achieve exposure through concentrated stock selection, while others balance exposures across diversified portfolios. These nuances arise from diverse objectives, constraints, and risk tolerances that are difficult to capture in a simple model. There, we proceed with a comprehensive approach, wherein we combine known metrics of an investment strategy with a flexible method that can detect general patterns. We again turn to a contemporaneous and backwards-looking approach: we want to explain the behaviours of fund managers in terms of the data public before and up to that point in time to do attribution. As with our factor model, we don’t want a predictive model where we predict what the portfolio looks like at a point in the future, as this is influenced by market forces that are fundamentally hard to predict, or high-frequency signals that we don’t have access to in our monthly data.<p>In the following sections we propose a generative model to replicate and understand fund managers’ strategies. This generative model is a modest extension to the earlier neural factor model developed in Chapter <a href=#chapter:return_attribution>3</a>.<h4 id=section:gans>Methods<a title="Permanent link" class=headerlink href=#section:gans></a></h4><p>Our objective is to learn the low-dimensional representation of a strategy (<a href=#equation:portfolio_manager_decoder>this equation</a>). The latent variable <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=bold>ϕ</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>\mathbf{\phi}_a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is inferred via an encoder function and serves as input to a conditional decoder.<p>Recall our factor model of Chapter <a href=#chapter:return_attribution>3</a>, where we are able to effectively compress the <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>K</mi></mrow><annotation encoding=application/x-tex>K</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal" style=margin-right:.07153em>K</span></span></span></span> economic variables and characteristics into one market factor and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>N</mi></mrow><annotation encoding=application/x-tex>N</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal" style=margin-right:.10903em>N</span></span></span></span> latent factors that best explain the returns. We can use this existing neural architecture to produce factor shocks <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>y</mi></mrow><annotation encoding=application/x-tex>\mathbf{y}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.6389em></span><span class="mord mathbf" style=margin-right:.01597em>y</span></span></span></span> and risk loadings <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>β</mi></mrow><annotation encoding=application/x-tex>\beta</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span></span></span>. We then extend this encoder to accept real-world portfolio weights <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>w</mi></mrow><annotation encoding=application/x-tex>\mathbf{w}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span></span></span>. The extended encoder function, which is going to encode the strategy vector <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϕ</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>\phi_a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> for portfolio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span>, can be expressed as:<p><span id=equation:portfolio_manager_encoder></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi><mo stretchy=false>(</mo><msub><mover accent=true><mi>ϕ</mi><mo>⃗</mo></mover><mi>a</mi></msub><mi mathvariant=normal>∣</mi><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi mathvariant=bold>w</mi><mo stretchy=false>)</mo><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>q(\vec{\phi}_a | \mathbf{X}, \mathbf{r}, \mathbf{w}),</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1.2274em></span><span class="mord mathnormal" style=margin-right:.03588em>q</span><span class=mopen>(</span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9774em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">ϕ</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1522em><span class=overlay style=width:.471em;height:.714em><svg viewbox="0 0 471 714" height=0.714em preserveaspectratio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5 3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11 10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63 -1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1 -7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59 H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359 c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord>∣</span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mclose>)</span><span class=mpunct>,</span></span></span></span></span><p>where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>q</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>q(\cdot)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class="mord mathnormal" style=margin-right:.03588em>q</span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span> denotes the approximate posterior distribution over the latent strategy variable <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>ϕ</mi><mo>⃗</mo></mover><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>\vec{\phi}_a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.1719em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9774em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">ϕ</span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1522em><span class=overlay style=width:.471em;height:.714em><svg viewbox="0 0 471 714" height=0.714em preserveaspectratio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5 3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11 10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63 -1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1 -7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59 H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359 c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> inferred from the data.<p>Together with the encoder we train the decoder of <a href=#equation:portfolio_manager_decoder>this equation</a>, which produces weights by decoding the latent representation in the context of a universe of stocks to potentially invest in. In practice, we have substituted <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>β</mi></mrow><annotation encoding=application/x-tex>\mathbf{\beta}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span></span></span> for <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>X</mi></mrow><annotation encoding=application/x-tex>\mathbf{X}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6861em></span><span class="mord mathbf">X</span></span></span></span>, as the factor model summarises the variables of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>X</mi></mrow><annotation encoding=application/x-tex>\mathbf{X}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6861em></span><span class="mord mathbf">X</span></span></span></span> in a manageable small number of variables that explain the returns, and this reduces memory usage and computation time. Note that here in <a href=#equation:portfolio_manager_decoder>this equation</a>, the decoder is not just tasked with recovering the original weights as observed in the real data, but that it is trained to generate sets plausible weights for arbitrary universes of financial instruments <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbf{X}, \mathbf{r})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class=mopen>(</span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mclose>)</span></span></span></span>, meaning there are usually many valid solutions.<p>The factor model gives us this opportunity: given a reference population <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>I</mi></mrow><annotation encoding=application/x-tex>i=1,2,\ldots,I</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.07847em>I</span></span></span></span> of financial instruments, we can fit our model and draw from the typical exposures <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi mathvariant=bold>β</mi><mo>~</mo></mover></mrow><annotation encoding=application/x-tex>\mathbf{\tilde{\beta}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.1523em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9579em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2042em><span class="mord mathbf">~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span></span></span>. Importantly, we also imply a stochastic discount factor (see Appendix <a href=#section:theoretical_frameowrk>A</a> for details) so that we can generate arbitrage-free prices. It is important to generate arbitrage free prices when training the network to recreate a portfolio, as unrealistically large arbitrage opportunities allow the network to obtain any risk-return trade-off without effort. It would then fail to pick up on the optimising that is evident in the fund managers portfolios, and not generalise to capture this behaviour.<p>To generate realistic returns time series, we sample the factor shocks series <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi mathvariant=bold>y</mi><mo>^</mo></mover></mrow><annotation encoding=application/x-tex>\hat{\mathbf{y}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.9023em></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>y</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span></span></span> as a Brownian motion which is our strong prior. Note that although the model when calibrated had a nearly identity covariance <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>Σ</mi><mi mathvariant=bold>y</mi></msub></mrow><annotation encoding=application/x-tex>\Sigma_{\mathbf{y}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class=mord>Σ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1611em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style=margin-right:.01597em>y</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> matrix, we use this to make the samples more realistic in contrast with the prior of the theoretical model. Additionally, we sample i.i.d. innovations <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>ϵ</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>∼</mo><mi mathvariant=script>N</mi><mrow><mo fence=true>(</mo><msub><mover accent=true><mi>ϵ</mi><mo>ˉ</mo></mover><mi>i</mi></msub><mo separator=true>,</mo><msub><mi>s</mi><msub><mi>ϵ</mi><mi>i</mi></msub></msub><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>\hat{\epsilon}_{i,t} \sim \mathcal{N}\left( \bar{\epsilon}_{i}, s_{\epsilon_{i}}\right)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">ϵ</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∼</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.2501em;height:1.0001em></span><span class="mord mathcal" style=margin-right:.14736em>N</span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0>(</span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.5678em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">ϵ</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>ˉ</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3281em><span style=margin-left:0;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2501em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0>)</span></span></span></span></span> to produce<p><span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>r</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mover accent=true><mi>α</mi><mo>~</mo></mover><mi>i</mi></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mover accent=true><mi>β</mi><mo>~</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub><msub><mover accent=true><mi>y</mi><mo>^</mo></mover><mrow><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi mathvariant=normal>Γ</mi><mi>n</mi></msub><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><msub><mover accent=true><mi>β</mi><mo>~</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub><mi mathvariant=normal>∣</mi><mi mathvariant=normal>∣</mi><mo>+</mo><msub><mover accent=true><mi>ϵ</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mi mathvariant=normal>.</mi></mrow><annotation encoding=application/x-tex>{\hat{r}}_{i,t} = \tilde{\alpha}_i + \sum_{n=1}^{N}{\tilde{\beta}}_{i,n} \hat{{y}}_{n,t} - \sum_{n=1}^{N}\Gamma_n ||\tilde\beta_{i,n}||+ \hat{\epsilon}_{i,t}.</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.02778em>r</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.15em;height:.8179em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6679em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.0037em>α</span></span><span style=top:-3.35em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2222em><span class=mord>~</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0037em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-1.2671em;height:3.0954em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9313em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2175em><span style=margin-right:.05em;top:-2.4559em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3802em><span></span></span></span></span></span></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal" style=margin-right:.03588em>y</span></span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-1.2671em;height:3.0954em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord>Γ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mord>∣∣</span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9313em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord>∣∣</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>+</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">ϵ</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord>.</span></span></span></span></span><p>Herein, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>α</mi><mo>~</mo></mover><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\tilde{\alpha}_i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8179em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6679em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.0037em>α</span></span><span style=top:-3.35em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2222em><span class=mord>~</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0037em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is the idiosyncratic return for stock <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>β</mi><mo>~</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\tilde{\beta}_{i,n}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:1.2174em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9313em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> are the factor loadings for stock <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>i</mi></mrow><annotation encoding=application/x-tex>i</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6595em></span><span class="mord mathnormal">i</span></span></span></span> on factor <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>y</mi><mo>^</mo></mover><mrow><mi>n</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\hat{y}_{n,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.03588em>y</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0359em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> is the factor shock for factor <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span></span></span></span> at time <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>t</mi></mrow><annotation encoding=application/x-tex>t</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6151em></span><span class="mord mathnormal">t</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=normal>Γ</mi><mi>n</mi></msub></mrow><annotation encoding=application/x-tex>\Gamma_n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8333em></span><span class=mord><span class=mord>Γ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is the vector of market prices of risk for risk-factors <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi></mrow><annotation encoding=application/x-tex>n</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">n</span></span></span></span> ensuring arbitrage-free pricing, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mover accent=true><mi>ϵ</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\hat{\epsilon}_{i,t}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9805em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">ϵ</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1944em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span> is the idiosyncratic noise term.<p>The challenge therein is that we cant simply compare the portfolio allocations as observed in the regulatory filings <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>w</mi></mrow><annotation encoding=application/x-tex>\mathbf{w}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span></span></span> and those generated on fictitious stock universes and returns as there is no ground truth on how the real-world fund manager would have allocated their capital on this fictitious set of stocks.<h4 id=section:gan_validation>Validation<a title="Permanent link" class=headerlink href=#section:gan_validation></a></h4><p>To learn to portfolios and identify deviations in aspects such as factor exposures, mean-variance optimisation or turnover patterns without requiring explicit specification of these features, we need an alternate approach where the loss function is implicit. [@Goodfellow2014GenerativeNetworks] propose a neural network design comprising two components: the which learns to produce realistic portfolio weights, and a second neural network that is trained to distinguish between the real data and the samples that the generator produces. As the observable data generated by the generator can’t be judged on its own, but must be put into the contexts of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>β</mi><mo>~</mo></mover></mrow><annotation encoding=application/x-tex>\mathbf{\hat{w}}\mathbf{\tilde\beta}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:1.1523em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9579em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2042em><span class="mord mathbf">~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span></span></span></span> to evaluate factor exposures, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover></mrow><annotation encoding=application/x-tex>\mathbf{\hat{w}}\mathbf{\hat{r}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.7079em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf">r</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span></span></span></span> to evaluate the distribution of returns and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mo>−</mo><mi mathvariant=bold>w</mi></mrow><annotation encoding=application/x-tex>\mathbf{\hat{w}} - \mathbf{w}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.0833em;height:.7912em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span></span></span> to investigate such things as the turnover rate and liquidity limits, the output is the rather high-dimensional triple <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>β</mi><mo>~</mo></mover><mo separator=true>,</mo><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover><mo separator=true>,</mo><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mo>−</mo><mi mathvariant=bold>w</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>(\mathbf{\hat{w}}\mathbf{\tilde\beta}, \mathbf{\hat{w}}\mathbf{\hat{r}}, \mathbf{\hat{w}} - \mathbf{w})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1.2079em></span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9579em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2042em><span class="mord mathbf">~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf">r</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mclose>)</span></span></span></span>. A class of loss functions based on the Wasserstein distance <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>d</mi><mtext>W</mtext></msub></mrow><annotation encoding=application/x-tex>d_{\text{W}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8444em></span><span class=mord><span class="mord mathnormal">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">W</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is known to give good results in such cases [@Arjovsky2017WassersteinGAN; @Gulrajani2017ImprovedGANs], and we use that as:<p><span id=equation:wasserstein_loss></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>S</mi><mi mathvariant=normal>t</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>t</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>g</mi><mi mathvariant=normal>y</mi></mrow></msub><mo>=</mo><msub><mi mathvariant=double-struck>E</mi><mrow><mi mathvariant=bold>w</mi><mo separator=true>,</mo><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover></mrow></msub><mo fence=false maxsize=1.2em minsize=1.2em stretchy=true>[</mo><msub><mi>d</mi><mtext>W</mtext></msub><mo stretchy=false>(</mo><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>β</mi><mo>~</mo></mover><mo separator=true>,</mo><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover><mo separator=true>,</mo><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mo>−</mo><mi mathvariant=bold>w</mi><mo stretchy=false>)</mo><mo fence=false maxsize=1.2em minsize=1.2em stretchy=true>]</mo><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{Strategy}} = \mathbb{E}_{\mathbf{w}, \hat{\mathbf{w}}} \big[ d_{\text{W}}(\mathbf{\hat{w}}\mathbf{\tilde{\beta}}, \mathbf{\hat{w}}\mathbf{\hat{r}}, \mathbf{\hat{w}} - \mathbf{w}) \big],</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight" style=margin-right:.01389em>Strategy</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.35em;height:1.3079em></span><span class=mord><span class="mord mathbb">E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.05em;top:-2.5493em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight" style=margin-right:.01597em>w</span><span class="mpunct mtight">,</span><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-2.7em><span class=pstrut style=height:2.7em></span><span class="mord mathbf mtight" style=margin-right:.01597em>w</span></span><span style=top:-2.7134em><span class=pstrut style=height:2.7em></span><span class=accent-body style=left:-.1667em><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2868em><span></span></span></span></span></span></span><span class=mord><span class="delimsizing size1">[</span></span><span class=mord><span class="mord mathnormal">d</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">W</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9579em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2042em><span class="mord mathbf">~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf">r</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.35em;height:1.2em></span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mclose>)</span><span class=mord><span class="delimsizing size1">]</span></span><span class=mpunct>,</span></span></span></span></span><p>A persistent issue with GANs is that their learning can be quite unstable [@Arjovsky2017WassersteinGAN]: when the discriminator is not able to distinguish between real-data samples and generated samples because it is lacking in its design or capacity, we can’t use its gradients to improve the generator, resulting in the generator generating unrealistic samples. In the opposite direction, when the discriminator is too powerful and overfits to the real-world data samples and rejects anything the generator innovates, the generator might collapse and only generate samples close to the original data. This isn’t a problem in our case, since our objective ultimately is not to generate as many plausible investment universes as possible, but to get useful latent representations for investment strategies and a decoder that can implement them.<p>A simple way to stabilise the learning is to add regularisation terms to the loss function using properties of the portfolio that we have already determined are important. In our case we have some of these, the simplest are: the mean risk-factor exposure for the portfolio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mn>1</mn><mi>I</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></msubsup><msub><mover accent=true><mi>w</mi><mo>^</mo></mover><mi>i</mi></msub><msub><mover accent=true><mi>β</mi><mo>~</mo></mover><mi>i</mi></msub></mrow><annotation encoding=application/x-tex>\frac{1}{I}\sum_{i=1}^{I}{\hat{w}_i}{\tilde\beta_i}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.345em;height:1.3262em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8451em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.394em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.345em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.1667em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=margin-right:.05em;top:-3.2029em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span><span class=mord><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9313em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span>, the Sharpe ratio <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mfrac><mrow><mover accent=true><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover></mrow><mo>ˉ</mo></mover><mo>−</mo><msub><mi>r</mi><mi>f</mi></msub></mrow><msub><mi>s</mi><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover></mrow></msub></mfrac></mrow><annotation encoding=application/x-tex>\frac{\bar{\mathbf{\hat{w}}\mathbf{\hat{r}}} - r_f}{s_{\mathbf{\hat{w}}\mathbf{\hat{r}}}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.4576em;height:1.5619em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.1043em><span style=top:-2.655em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.0714em;top:-2.3448em><span class=pstrut style=height:2.5056em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-2.6944em><span class=pstrut style=height:2.6944em></span><span class="mord mathbf mtight" style=margin-right:.01597em>w</span></span><span style=top:-2.7079em><span class=pstrut style=height:2.6944em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf mtight">^</span></span></span></span></span></span></span><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-2.6944em><span class=pstrut style=height:2.6944em></span><span class="mord mathbf mtight">r</span></span><span style=top:-2.7079em><span class=pstrut style=height:2.6944em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1608em><span></span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.5131em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8447em><span style=top:-2.7079em><span class=pstrut style=height:2.7079em></span><span class="mord mtight"><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-2.7em><span class=pstrut style=height:2.7em></span><span class="mord mathbf mtight" style=margin-right:.01597em>w</span></span><span style=top:-2.7134em><span class=pstrut style=height:2.7em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf mtight">^</span></span></span></span></span></span></span><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-2.7em><span class=pstrut style=height:2.7em></span><span class="mord mathbf mtight">r</span></span><span style=top:-2.7134em><span class=pstrut style=height:2.7em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf mtight">^</span></span></span></span></span></span></span></span></span><span style=top:-2.9848em><span class=pstrut style=height:2.7079em></span><span class=accent-body style=left:-.25em><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:-.0278em;margin-right:.0714em;top:-2.3488em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style=margin-right:.10764em>f</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2901em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.4576em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, and the turnover rate <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></msubsup><mo stretchy=false>(</mo><msub><mover accent=true><mi>w</mi><mo>^</mo></mover><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>\sum_{i=1}^{I}({\hat{w}_i} - {w}_i)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2997em;height:1.2809em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=margin-right:.05em;top:-3.2029em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mopen>(</span><span class=mord><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span>. We put these statistics into a single regularisation term using the squares of the errors:<p><span id=equation:mean_exposure_regularization></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>e</mi><mi mathvariant=normal>x</mi><mi mathvariant=normal>p</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>s</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>e</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msup><mrow><mo fence=true>(</mo><mo stretchy=false>(</mo><msub><mover accent=true><mi>w</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo stretchy=false>)</mo><msub><mover accent=true><mi>β</mi><mo>~</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>n</mi></mrow></msub><mo fence=true>)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{exposure}} = \sum_{n=1}^{N} \left((\hat{w}_{i,t} - w_{i,t}) \tilde{\beta}_{i,n}\right)^2</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">exposure</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.2671em;height:3.0954em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8829em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2671em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mopen>(</span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9313em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span><span style=top:-3.6134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>~</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.354em><span style=margin-right:.05em;top:-3.6029em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><p><span id=equation:sharpe_regularization></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>S</mi><mi mathvariant=normal>h</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>p</mi><mi mathvariant=normal>e</mi></mrow></msub><mo>=</mo><msup><mrow><mo fence=true>(</mo><mfrac><mrow><mover accent=true><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover></mrow><mo>ˉ</mo></mover><mo>−</mo><msub><mi>r</mi><mi>f</mi></msub></mrow><msub><mi>s</mi><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover></mrow></msub></mfrac><mo>−</mo><mfrac><mrow><mover accent=true><mrow><mi mathvariant=bold>w</mi><mi mathvariant=bold>r</mi></mrow><mo>ˉ</mo></mover><mo>−</mo><msub><mi>r</mi><mi>f</mi></msub></mrow><msub><mi>s</mi><mrow><mi mathvariant=bold>w</mi><mi mathvariant=bold>r</mi></mrow></msub></mfrac><mo fence=true>)</mo></mrow><mn>2</mn></msup><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{Sharpe}} =\left(\frac{\bar{\mathbf{\hat{w}}\mathbf{\hat{r}}} - r_f}{s_{\mathbf{\hat{w}}\mathbf{\hat{r}}}} - \frac{\bar{\mathbf{{w}}\mathbf{{r}}} - r_f}{s_{\mathbf{{w}}\mathbf{{r}}}}\right)^2,</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Sharpe</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.95em;height:2.6757em></span><span class=minner><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size3">(</span></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.5217em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.05em;top:-2.5493em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-2.7em><span class=pstrut style=height:2.7em></span><span class="mord mathbf mtight" style=margin-right:.01597em>w</span></span><span style=top:-2.7134em><span class=pstrut style=height:2.7em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf mtight">^</span></span></span></span></span></span></span><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-2.7em><span class=pstrut style=height:2.7em></span><span class="mord mathbf mtight">r</span></span><span style=top:-2.7134em><span class=pstrut style=height:2.7em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1507em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8447em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf">r</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span></span></span><span style=top:-3.2769em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.25em><span class=mord>ˉ</span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.10764em>f</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.8367em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.2603em><span style=top:-2.314em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathnormal">s</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1611em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight" style=margin-right:.01597em>w</span></span><span class="mord mtight"><span class="mord mathbf mtight">r</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.677em><span class=pstrut style=height:3em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.5812em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span class=mord><span class="mord mathbf">r</span></span></span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.25em><span class=mord>ˉ</span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0278em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.10764em>f</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.836em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size3">)</span></span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.7257em><span style=margin-right:.05em;top:-3.9746em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mpunct>,</span></span></span></span></span><p><span id=equation:turnover_regularization></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>t</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>n</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>v</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>r</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>I</mi></munderover><mo fence=false maxsize=1.2em minsize=1.2em stretchy=true>∣</mo><msub><mover accent=true><mi>w</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>−</mo><msub><mover accent=true><mi>w</mi><mo>^</mo></mover><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow></msub><mo fence=false maxsize=1.2em minsize=1.2em stretchy=true>∣</mo><mo>−</mo><mo fence=false maxsize=1.2em minsize=1.2em stretchy=true>∣</mo><msub><mi>w</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>i</mi><mo separator=true>,</mo><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow></msub><mo fence=false maxsize=1.2em minsize=1.2em stretchy=true>∣</mo><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{turnover}} = \sum_{i=1}^I \big| \hat{w}_{i,t} - \hat{w}_{i,t{-}1} \big| - \big| {w}_{i,t} - {w}_{i,t{-}1} \big|,</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8333em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">turnover</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-1.2777em;height:3.106em></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.8283em><span style=margin-left:0;top:-1.8723em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=top:-3.05em><span class=pstrut style=height:3.05em></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style=margin-left:0;top:-4.3em><span class=pstrut style=height:3.05em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.07847em>I</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.2777em><span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.85em><span style=top:-2.85em><span class=pstrut style=height:3.2em></span><span style=width:.333em;height:1.2em><svg viewbox="0 0 333 1200" height=1.200em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z"></path></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.35em><span></span></span></span></span></span></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.35em;height:1.2em></span><span class=mord><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.6944em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>^</span></span></span></span></span></span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.85em><span style=top:-2.85em><span class=pstrut style=height:3.2em></span><span style=width:.333em;height:1.2em><svg viewbox="0 0 333 1200" height=1.200em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z"></path></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.35em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.35em;height:1.2em></span><span class=mord><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.85em><span style=top:-2.85em><span class=pstrut style=height:3.2em></span><span style=width:.333em;height:1.2em><svg viewbox="0 0 333 1200" height=1.200em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z"></path></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.35em><span></span></span></span></span></span></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.35em;height:1.2em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3117em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mord><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.85em><span style=top:-2.85em><span class=pstrut style=height:3.2em></span><span style=width:.333em;height:1.2em><svg viewbox="0 0 333 1200" height=1.200em width=0.333em xmlns=http://www.w3.org/2000/svg><path d="M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z"></path></svg></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.35em><span></span></span></span></span></span></span><span class=mpunct>,</span></span></span></span></span><p>There are many more statistics of these variables that one can add, but these three statistics fully cover all variables (<span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>X</mi></mrow><annotation encoding=application/x-tex>\mathbf{X}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6861em></span><span class="mord mathbf">X</span></span></span></span> or <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>β</mi></mrow><annotation encoding=application/x-tex>\mathbf{\beta}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span></span></span>, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>r</mi></mrow><annotation encoding=application/x-tex>\mathbf{r}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf">r</span></span></span></span>, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>w</mi></mrow><annotation encoding=application/x-tex>\mathbf{w}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span></span></span>). Fine-tuning of these This makes for explainable metrics that also aid as diagnostics during training, and leaves the discriminator to focus on higher-order complex functions of the data. This complements the rational agents approach, where one would presuppose a function<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup> of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi mathvariant=bold>w</mi><mo>^</mo></mover><mover accent=true><mi mathvariant=bold>r</mi><mo>^</mo></mover></mrow><annotation encoding=application/x-tex>\mathbf{\hat{w}}\mathbf{\hat{r}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.7079em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.7079em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf">r</span></span><span style=top:-3.0134em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2875em><span class="mord mathbf">^</span></span></span></span></span></span></span></span></span></span>.<h4 id=discriminators-loss-function>Discriminator’s Loss Function<a title="Permanent link" class=headerlink href=#discriminators-loss-function></a></h4><p>The discriminator is trained to differ between real portfolios drawn from the data and synthetic samples created by the generator, and is informed about the trading strategy that is supposed to have made these allocations.<p>In this neural network design, a widely-used construction is to train the generator network based on feedback from the discriminator. This feedback takes the form of another loss: we define a critic loss <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mi>D</mi></msub></mrow><annotation encoding=application/x-tex>\mathcal{L}_D</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8333em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02778em>D</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> that measures how much more realistic the discriminator considers real portfolios compared to synthetic ones:<p><span id=equation:wgan_critic_loss></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mi>D</mi></msub><mo>=</mo><msub><mi mathvariant=double-struck>E</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi mathvariant=bold>w</mi><mo stretchy=false>)</mo><mo>∼</mo><msub><mi>p</mi><mrow><mi mathvariant=normal>d</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>t</mi><mi mathvariant=normal>a</mi></mrow></msub></mrow></msub><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>[</mo><mi>D</mi><mo stretchy=false>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi mathvariant=bold>w</mi><mo separator=true>,</mo><mi mathvariant=bold-italic>ϕ</mi><mo stretchy=false>)</mo><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>]</mo><mo>−</mo><msub><mi mathvariant=double-struck>E</mi><mrow><mo stretchy=false>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi mathvariant=bold-italic>ϕ</mi><mo stretchy=false>)</mo><mo>∼</mo><msub><mi>p</mi><mi>G</mi></msub></mrow></msub><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>[</mo><mi>D</mi><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi>G</mi><mo stretchy=false>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi mathvariant=bold-italic>ϕ</mi><mo stretchy=false>)</mo><mo separator=true>,</mo><mi mathvariant=bold-italic>ϕ</mi><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>)</mo><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>]</mo><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\mathcal{L}_D = \mathbb{E}_{ (\mathbf{X},\mathbf{r},\mathbf{w}) \sim p_{\mathrm{data}}}\bigl[D(\mathbf{X},\mathbf{r},\mathbf{w}, \boldsymbol{\phi})\bigr] - \mathbb{E}_{(\mathbf{X}, \mathbf{r},\boldsymbol{\phi}) \sim p_{G}}\bigl[D\bigl(\mathbf{X}, \mathbf{r}, G(\mathbf{X}, \mathbf{r},\boldsymbol{\phi}), \boldsymbol{\phi}\bigr)\bigr],</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8333em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style=margin-right:.02778em>D</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.3552em;height:1.2052em></span><span class=mord><span class="mord mathbb">E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.05em;top:-2.5198em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathbf mtight">X</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">r</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight" style=margin-right:.01597em>w</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.0714em;top:-2.3488em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">data</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1512em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3552em><span></span></span></span></span></span></span><span class=mopen><span class="delimsizing size1">[</span></span><span class="mord mathnormal" style=margin-right:.02778em>D</span><span class=mopen>(</span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf" style=margin-right:.01597em>w</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord><span class="mord boldsymbol">ϕ</span></span></span><span class=mclose>)</span><span class=mclose><span class="delimsizing size1">]</span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.3552em;height:1.2052em></span><span class=mord><span class="mord mathbb">E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.05em;top:-2.5198em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathbf mtight">X</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">r</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight">ϕ</span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.0714em;top:-2.3567em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1433em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3552em><span></span></span></span></span></span></span><span class=mopen><span class="delimsizing size1">[</span></span><span class="mord mathnormal" style=margin-right:.02778em>D</span><span class=mopen><span class="delimsizing size1">(</span></span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">G</span><span class=mopen>(</span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord><span class="mord boldsymbol">ϕ</span></span></span><span class=mclose>)</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord><span class="mord boldsymbol">ϕ</span></span></span><span class=mclose><span class="delimsizing size1">)</span></span><span class=mclose><span class="delimsizing size1">]</span></span><span class=mpunct>,</span></span></span></span></span><p>where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>D</mi><mo stretchy=false>(</mo><mo>⋅</mo><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>D(\cdot)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class="mord mathnormal" style=margin-right:.02778em>D</span><span class=mopen>(</span><span class=mord>⋅</span><span class=mclose>)</span></span></span></span> is the discriminator’s output, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>X</mi></mrow><annotation encoding=application/x-tex>\mathbf{X}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6861em></span><span class="mord mathbf">X</span></span></span></span> are real samples from the dataset, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>G</mi><mo stretchy=false>(</mo><mi mathvariant=bold>X</mi><mo separator=true>,</mo><mi mathvariant=bold>r</mi><mo separator=true>,</mo><mi mathvariant=bold-italic>ϕ</mi><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>G(\mathbf{X}, \mathbf{r},\boldsymbol{\phi})</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class="mord mathnormal">G</span><span class=mopen>(</span><span class="mord mathbf">X</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathbf">r</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class=mord><span class="mord boldsymbol">ϕ</span></span></span><span class=mclose>)</span></span></span></span> are the synthetic portfolios generated from latent variables <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold-italic>ϕ</mi></mrow><annotation encoding=application/x-tex>\boldsymbol{\phi}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class=mord><span class="mord boldsymbol">ϕ</span></span></span></span></span></span>.<p>Interpreting <a href=#equation:wgan_critic_loss>this equation</a>, by pairing samples from the true data and the synthetic data and asking the discriminator to estimate the distance between the two in terms of the Wasserstein distance, we obtain a differentiable loss that can be used to improve the generator. Because the discriminator is also trainable, we can use the same loss inverted to improve its weight, so that over time it becomes better at distinguishing real and fake samples. Then, generator and discriminator co-evolve during the training.<p>This co-evolution can result in unstable learning dynamics, where one of the components starts to overpower the other component, resulting in either the generator not getting the right feedback to improve, or the discriminator not being able to samples apart. We therefore add a gradient penalty () [@Gulrajani2017ImprovedGANs] term to keep the discriminator’s gradients under control:<p><span id=equation:wgan_gradient_penalty></span> <span class=katex-display><span class=katex><span class=katex-mathml><math display=block xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>g</mi><mi mathvariant=normal>p</mi></mrow></msub><mo>=</mo><mi>λ</mi><mo>⋅</mo><msub><mi mathvariant=double-struck>E</mi><mrow><mover accent=true><mi mathvariant=bold>X</mi><mo>^</mo></mover><mo>∼</mo><msub><mi>p</mi><mover accent=true><mi mathvariant=bold>X</mi><mo>^</mo></mover></msub></mrow></msub><mo fence=true maxsize=1.8em minsize=1.8em stretchy=true>[</mo><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>(</mo><mi mathvariant=normal>∣</mi><msub><mi mathvariant=normal>∇</mi><mover accent=true><mi mathvariant=bold>X</mi><mo>^</mo></mover></msub><mi>D</mi><mo stretchy=false>(</mo><mover accent=true><mi mathvariant=bold>X</mi><mo>^</mo></mover><mo stretchy=false>)</mo><msub><mi mathvariant=normal>∣</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn><msup><mo fence=true maxsize=1.2em minsize=1.2em stretchy=true>)</mo><mn>2</mn></msup><mo fence=true maxsize=1.8em minsize=1.8em stretchy=true>]</mo><mo separator=true>,</mo></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{gp}} = \lambda \cdot \mathbb{E}_{\hat{\mathbf{X}} \sim p_{\hat{\mathbf{X}}}} \Bigl[\bigl(|\nabla_{\hat{\mathbf{X}}}D(\hat{\mathbf{X}})|_{2} - 1\bigr)^2\Bigr],</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">gp</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal">λ</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>⋅</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.65em;height:1.8em></span><span class=mord><span class="mord mathbb">E</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.05em;top:-2.3801em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9495em><span style=top:-2.7em><span class=pstrut style=height:2.7em></span><span class="mord mathbf mtight">X</span></span><span style=top:-2.9551em><span class=pstrut style=height:2.7em></span><span class=accent-body style=left:-.1667em><span class="mord mtight">^</span></span></span></span></span></span></span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.0714em;top:-2.3448em><span class=pstrut style=height:2.6782em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9495em><span style=top:-2.6944em><span class=pstrut style=height:2.6944em></span><span class="mord mathbf mtight">X</span></span><span style=top:-2.9496em><span class=pstrut style=height:2.6944em></span><span class=accent-body style=left:-.1667em><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3334em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.5533em><span></span></span></span></span></span></span><span class=mopen><span class="delimsizing size2">[</span></span><span class=mopen><span class="delimsizing size1">(</span></span><span class=mord>∣</span><span class=mord><span class=mord>∇</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3448em><span style=margin-left:0;margin-right:.05em;top:-2.3801em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9495em><span style=top:-2.7em><span class=pstrut style=height:2.7em></span><span class="mord mathbf mtight">X</span></span><span style=top:-2.9551em><span class=pstrut style=height:2.7em></span><span class=accent-body style=left:-.1667em><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3199em><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:.02778em>D</span><span class=mopen>(</span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9495em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf">X</span></span><span style=top:-3.2551em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>^</span></span></span></span></span></span></span><span class=mclose>)</span><span class=mord><span class=mord>∣</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.65em;height:1.8em></span><span class=mord>1</span><span class=mclose><span class=mclose><span class="delimsizing size1">)</span></span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:1.054em><span style=margin-right:.05em;top:-3.3029em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose><span class="delimsizing size2">]</span></span><span class=mpunct>,</span></span></span></span></span><p>where <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>λ</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding=application/x-tex>\lambda=10</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal">λ</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>10</span></span></span></span> is a regularisation coefficient, and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mover accent=true><mi mathvariant=bold>X</mi><mo>^</mo></mover></mrow><annotation encoding=application/x-tex>\hat{\mathbf{X}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.9495em></span><span class="mord accent"><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.9495em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathbf">X</span></span><span style=top:-3.2551em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1667em><span class=mord>^</span></span></span></span></span></span></span></span></span></span> is interpolated between real and generated samples. The value of <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>λ</mi></mrow><annotation encoding=application/x-tex>\lambda</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6944em></span><span class="mord mathnormal">λ</span></span></span></span> found through experimentation: the value is increased if the learning process exhibits instability, or decreased if the regularisation is too constraining, hindering the generator’s ability to produce realistic samples as evidenced by no improvement in the generator’s loss.<figure><figcaption>Schematic of the GAN-based neural network architecture <strong>GC</strong>. At the top, dark-blue boxes denote the input data triple <span class="math inline">(<strong>X</strong>, <strong>r</strong>, <strong>w</strong>)</span>, including characteristics <span class="math inline"><strong>X</strong></span>, returns <span class="math inline"><strong>r</strong></span>, and weights <span class="math inline"><strong>w</strong></span>. These variables are mirrored by synthetically generated samples at the bottom, where the factor model for U.S. equities returns recreates a universe of stocks <span class="math inline">(<strong>X̂</strong>, <strong>r̂</strong>)</span>, and a neural network encoder-decoder pair is responsible for creating a realistic allocation <span class="math inline"><strong>ŵ</strong></span> over those stocks.</figcaption></figure><h4 id=evaluation>Evaluation<a title="Permanent link" class=headerlink href=#evaluation></a></h4><p>Interpreting the results of the Wasserstein GAN model poses inherent challenges due to the opaque nature of the discriminator’s learned criteria. The discriminator’s capacity to distinguish real samples from synthetic ones is contained in the deep neural network, making its decision process difficult to interpret. However, an observable metric is the Wasserstein distance, which serves as the model’s objective function (Section <a href=#section:gan_validation>1.3.4.2</a>). This distance quantifies the divergence between the distributions of real and generated data. We monitor the Wasserstein distance reported for validation samples from both distributions. A decreasing distance indicates improving alignment between the synthetic and real data distributions. When the discriminator cannot reliably distinguish between the two types of samples, the Wasserstein distance approaches a minimal value. Though not strictly a proof of equivalence of the two distribution, confusion of a powerful discriminator between the two distributions on the validation data is strong evidence for convergence of the training process.<p>To better understand the results, we investigate the latent variables of the auto-encoder, and put them into context of the Lipper classification which provides an expert labelling that we can use to interpret results.<p>Finally, we have a parsimonious set of statistics to compare the real-world data distributions with the synthetically generated sample in Equations <a href=#equation:mean_exposure_regularization>[equation:mean_exposure_regularization]</a>,<a href=#equation:sharpe_regularization>[equation:sharpe_regularization]</a>,<a href=#equation:turnover_regularization>[equation:turnover_regularization]</a>.<h2 id=results>Results<a title="Permanent link" class=headerlink href=#results></a></h2><p>In this section, we present the results of the analyses of real-world portfolios: stability under classification, mean-variance optimisation, and joint learning of the strategy through a neural network model.<h3 id=section:analysis_stability>Stability<a title="Permanent link" class=headerlink href=#section:analysis_stability></a></h3><p>We expect that if none of the factors are relevant to the strategies’ investment styles, that the observed drift in factor exposure <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>u</mi><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>l</mi></mrow></msub></mrow><annotation encoding=application/x-tex>u_{\mathrm{model}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.5806em></span><span class=mord><span class="mord mathnormal">u</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">model</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is on average equal to that under the null model, <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>u</mi><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>d</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>l</mi></mrow></msub></mrow><annotation encoding=application/x-tex>u_{\mathrm{model}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.5806em></span><span class=mord><span class="mord mathnormal">u</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">model</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>, which is designed to have equal turnover and randomly select stocks in proportion to their market capitalisation. Thus, the more factors are relevant to the strategies and the more managers coordinate on this, the lower the ratio of the two drift rates in the left panel in Figure <a href=#figure:null_model_comparison>1.4</a> is expected to be. The results in that histogram already strongly suggest that fund managers manage exposures better than a random trading model starting from the same portfolio, and so a numerical answer to the significance question is less meaningful. The median portfolio is observed to drift at one quarter of the drift rate of the random trading null model, and almost no observations match or exceed this rate as is seen in the histogram where the mass of the observations concentrates between one-tenth through one-third of the null model’s implied drift.<p>In Figure <a href=#figure:null_model_comparison>1.4</a> in the right panel, where we plot the averages of portfolios grouped by their stated objective, we see that index funds have the lowest drift in factor space, followed by core equities funds and then value funds. Finally, growth-oriented funds experience the most drift in average risk factor exposure, both as the realised drift in the funds and under the null model on the same universe of stocks. As in this comparison all portfolios are on large capitalisation stocks, this implies that it may be more difficult to maintain a steady exposure to growth-themed risk factors. This could be because growth stocks’ returns are more volatile and thus their fundamental valuation ratios are influenced by these market sentiments, but also because profitability of these firms is more variable [@Novy-Marx2013ThePremium].<figure id=figure:null_model_comparison><img src=/images/drift_model_null.png><figcaption>In this figure we show two measures of the stability of the classifying model compared to the stability of the null model proposed in Section <a data-reference=section:classifier_stability_null_model data-reference-type=ref href=#section:classifier_stability_null_model>[section:classifier_stability_null_model]</a>. In the histogram on the left, we count the ratios of the drift rate under the classification model to that under the null model, where we see that except for a small number of cases, the factor model produces a result that is more stable by four to five times in terms of the drift. In the panel on the right, we plot the averages of funds grouped by their objectives. There is moderate correlation between the drift rates as observed in the data and those implied by the null models. Under model measures of drift, the S&P 500 index funds have the smallest drift, whereas growth funds have on average the highest drift rate. The value and core funds overlap and fall between the index funds and growth funds.</figcaption></figure><p>Nevertheless, in Appendix <a href=#section:drift_significance_testing>A</a> we work out the statistical tests should we in the future want to compare more competitive models.<h3 id=section:analysis_markowitz_optimality>Analysis of Markowitz-Optimality<a title="Permanent link" class=headerlink href=#section:analysis_markowitz_optimality></a></h3><p>The average distance between the real-world portfolios and the Sharpe-ratio optimised portfolio with the same factor exposures is 0.18 Sharpe. The distance between the realised portfolios and the unconstrained Sharpe-optimised portfolio 0.52 Sharpe, being much larger, indicating that most portfolios are plausibly constrained in part by their factor exposures, but this does not preclude other possibilities, such as the optimisation for other portfolio aspects such as the minimisation of turnover rate, or the failure the maintain a Markowitz-optimal portfolio in dynamic market conditions, or the usage of a different window of historic data in the backtest that are used to estimate the parameters to the optimisation problem.<p>On average, fewer than one in ten portfolios outperforms random portfolios with the same factor characteristics at the 1% confidence level. In other words, in the aggregated If the fraction of portfolios that are optimised is 0.09 at the 1% confidence level, then we need to adjust our estimate down by 1% false positives to 8% of portfolios.<p>There is high heterogeneity among the portfolios. In Figure <a href=#figure:markowitz_optimisation_test>1.5</a>, we observe that not only those portfolios close to the efficient frontier are likely optimised, but that there are also portfolios further away from the efficient frontier that are likely optimised. This is because on some sets (universes) of stocks, it much harder to find a combination of weights that is optimal in risk-adjusted reward terms, and there a small perturbation may have large implications for the realised ex-post Sharpe ratio. Contrast this with for example a set of stocks that is highly similar in all attributes and returns: there it is not difficult to find an allocation that is close to optimal in terms of the Sharpe ratio.<figure id=figure:markowitz_optimisation_test><img src=/images/sharpe_ratios_markowitz.4.png><figcaption>Circular markers denote portfolios for which we can’t ascertain that they are Markowitz-optimised, with or without style constraint. Triangles mark portfolios that are likely optimised (at the 1% confidence level). The diagonal represents the line of Sharpe ratio optimality on the backtest. The portfolios are evaluated on the 60 months ending January 2020, a period with market-wide good returns, leading to a high average realised Sharpe ratio.</figcaption></figure><p>We plot in figure <a href=#figure:markowitz_optimisation_test>1.5</a> the retrospective Sharpe ratios for the S&P 500 Index funds, Growth, Core and Value portfolios for January 2020. First, we observe that the sixty months preceding to this point in time resulted in good results for the buy and hold portfolios on average with a Sharpe ratio of 0.8. This period is also characterised by Value portfolios underperforming, and on the typical Growth portfolio outperforming the Core and Index funds slightly. Analysing the results, we see that index funds all sit at the same coordinate of a 0.8 realised Sharpe ratio, and our hypothesis test tells us no more of them are likely optimised beyond the false positive rate of 1%. This is expected, as the index funds target market capitalisation weights, and thus do not exploit expectations about future returns. Similarly, the Core portfolios in the vicinity of the index funds in terms of composition are rarely found to be optimised. Then, we also observe that near the Sharpe-ratio optimal boundary, nearly all portfolio pass the null-hypothesis test and are deemed to be optimised, and the more we move away from the boundary the less likely it is that portfolios pass the null-model test. There is however no sharp border between the two. This is because the universes of stocks are different between portfolios. For some sets of stocks, for example where the stocks are highly similar, it may be easy to land on a near-optimal allocation by chance. In such universes, the threshold for a portfolio to outperform the null model in the backtest is much higher, and so many portfolios are likely flagged as not being optimised. Conversely, if the universe of stocks is large and demands a complex combination of many non-zero positions, it may be very hard to arrive at an optimised portfolio by chance, and so a portfolio that is optimised does not necessarily have to be close to the optimality boundary in terms of the Sharpe distance.<p>The breakdown per prospectus objective for year-end 2019 is summarised in Table <a href=#table:optimised_portfolios_percentages>1.3</a>:<table><thead><tr><th>Objective<th>Est. Percentage Optimised<tbody><tr><td>S&P 500<td>0.0%<tr><td>Growth (all market caps)<td>56.3%<tr><td>Core (all market caps)<td>27.0%<tr><td>Value (all market caps)<td>55.5%<tr><td>Income<td>23.6%</table><dl><dd>This table lists the estimated percentage of portfolios that are likely risk-reward optimised, separated to the objective code as stated in the prospectus.</dl><p>[]{#table:optimised_portfolios_percentages label=”table:optimised_portfolios_percentages”}<p>None of the S&P 500 index tracking funds appear to be optimising. This is not surprising, as the task of index funds is to track the index by market capitalisation weight, and except for the rare case where the optimal portfolio weights’ coincide with the market capitalisation weighted portfolio, the portfolio weights are likely to be different.<p>We learn that style portfolios in either the growth or the value category are most likely to optimise their portfolio. Core portfolios, which already have much overlap with S&P 500 index funds, don’t appear to optimise that often, which suggests that many core funds may not offer much beyond what an index-tracking fund does. Finally, income funds have also low likelihood of optimisation under our test. In our test using total returns, we do not account for the dynamics of distributions such as dividends separately. Therefore, it is possible that income funds design their portfolios with other objectives in mind, such as expectations about future dividend streams that are not easily captured in the risk-adjusted optimisation Markowitz framework.<h3 id=section:learning_to_manage_portfolio>Learning to Manage a Portfolio<a title="Permanent link" class=headerlink href=#section:learning_to_manage_portfolio></a></h3><p>We train the proposed neural network model from Section <a href=#section:gans>1.3.4.1</a> on portfolios filtered for complete data (requirements in Section <a href=#section:data_coverage_portfolios>1.2.2</a>) and filtered to have a Lipper classification. Furthermore, we restrict the range to the dates from 2010 through 2022, as the data coverage after 2010 is complete and captures almost all major mutual funds. We fix the number of latent variables <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=normal>∣</mi><mover accent=true><msub><mi>ϕ</mi><mi>a</mi></msub><mo>⃗</mo></mover><mi mathvariant=normal>∣</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding=application/x-tex>|\vec{\phi_a}|=10</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1.2274em></span><span class=mord>∣</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9774em><span style=top:-3em><span class=pstrut style=height:3em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span><span style=top:-3.2634em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.2355em><span class=overlay style=width:.471em;height:.714em><svg viewbox="0 0 471 714" height=0.714em preserveaspectratio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5 3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11 10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63 -1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1 -7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59 H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359 c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=mord>∣</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>10</span></span></span></span>. We arrive at this number by giving the encoder at least eight variables to describe the risk-factor exposures for the portfolio: the idiosyncratic returns <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>α</mi></mrow><annotation encoding=application/x-tex>\alpha</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal" style=margin-right:.0037em>α</span></span></span></span>, market beta <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>β</mi><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>k</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\beta_{\mathrm{market}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">market</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>, and the six latent factors <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=bold>β</mi><mi>n</mi></msub><mo separator=true>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mo separator=true>,</mo><mn>2</mn><mo separator=true>,</mo><mo>…</mo><mo separator=true>,</mo><mi>N</mi></mrow><annotation encoding=application/x-tex>\mathbf\beta_{n}, n=1,2,\ldots,N</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal">n</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.1944em;height:.8778em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>2</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=minner>…</span><span class=mspace style=margin-right:.1667em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class="mord mathnormal" style=margin-right:.10903em>N</span></span></span></span> make up the first eight variables of the strategy. To this, we add an additional dimension for a returns-based description of the portfolio and a tenth variable for a turnover-based description. By partitioning the encoder so that the first eight latent variables can only be set by the part of the network observing the risk exposures and weights, we prevent the fusing of signals relating to the different tasks. This improves interpretation and prevents the signal of one task crowding out that of others, but comes at the theoretical cost of having reduced capacity in the latent representation compared when the signals are allowed to be mixed.<h4 id=section:style_representation_experiment>Style Representation<a title="Permanent link" class=headerlink href=#section:style_representation_experiment></a></h4><p>With one latent variable to describe the portfolios alpha and risk factor loadings, in theory there is just enough bandwidth to describe one important statistic of these variables, for example the mean factor exposure, but we can’t exclude the importance of higher moments of the distribution of exposures. In our experiment, however, we find that the information content in the portfolio weights as projected on the risk factor loadings is low, as when typically training the model the strategy encoder uses only six or seven out of eight available latent variables depending on random initialisation, as evidence by a constant output for these latent variables and zero gradients.<p>Of course, it is possible that the neural network encoder manages to summarise many important statistics by learning highly complicated correlations between portfolios. However, using simple linear analysis of the data we confirm this is likely not the case.<p>Take the tensor of weights <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>w</mi></mrow><annotation encoding=application/x-tex>\mathbf{w}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf" style=margin-right:.01597em>w</span></span></span></span> at one point in time. We investigate the projection <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mi>t</mi></msub><mi mathvariant=bold>β</mi></mrow><annotation encoding=application/x-tex>w_t \mathbf{\beta}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:-.0269em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mord mathnormal" style=margin-right:.05278em>β</span></span></span></span>. An estimate for the effective number of factors is the of the distribution of contributions of each weighted factor to the total variance.<p><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>H</mi><mo stretchy=false>(</mo><mover accent=true><mi>p</mi><mo>⃗</mo></mover><mo stretchy=false>)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence=true>(</mo><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>p</mi><mi>n</mi></msub><mi>ln</mi><mo>⁡</mo><msub><mi>p</mi><mi>n</mi></msub><mo fence=true>)</mo></mrow><mo separator=true>;</mo><mtext> </mtext><msub><mi>p</mi><mi>n</mi></msub><mo>=</mo><mrow><mo fence=true>(</mo><mfrac><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy=false>(</mo><msub><mi>w</mi><mi>t</mi></msub><msub><mi mathvariant=bold>β</mi><mi>n</mi></msub><mo stretchy=false>)</mo></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>m</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy=false>(</mo><msub><mi>w</mi><mi>t</mi></msub><msub><mi mathvariant=bold>β</mi><mi>m</mi></msub><mo stretchy=false>)</mo></mrow></mfrac><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>H(\vec{p}) = \exp\left(-\sum_{n=1}^{N} p_n \ln p_n\right);~ p_n=\left(\frac{Var({w_t}\mathbf{\beta}_n) }{\sum_{m=1}^{N} Var({w_t}\mathbf{\beta}_m)}\right)</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class="mord mathnormal" style=margin-right:.08125em>H</span><span class=mopen>(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.714em><span style=top:-3em><span class=pstrut style=height:3em></span><span class="mord mathnormal">p</span></span><span style=top:-3em><span class=pstrut style=height:3em></span><span class=accent-body style=left:-.1522em><span class=overlay style=width:.471em;height:.714em><svg viewbox="0 0 471 714" height=0.714em preserveaspectratio=xMinYMin style=width:.471em width=0.471em xmlns=http://www.w3.org/2000/svg><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5 3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11 10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63 -1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1 -7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59 H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359 c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.1944em><span></span></span></span></span></span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.65em;height:1.8em></span><span class=mop>exp</span><span class=mspace style=margin-right:.1667em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mord>−</span><span class=mspace style=margin-right:.1667em></span><span class=mop><span class="mop op-symbol small-op" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.9812em><span style=margin-left:0;margin-right:.05em;top:-2.4003em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=margin-right:.05em;top:-3.2029em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2997em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mop>ln</span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span><span class=mspace style=margin-right:.1667em></span><span class=mpunct>;</span><span class="mspace nobreak"> </span><span class=mspace style=margin-right:.1667em></span><span class=mord><span class="mord mathnormal">p</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=vertical-align:-.6547em;height:1.8047em></span><span class=minner><span class="mopen delimcenter" style=top:0><span class="delimsizing size2">(</span></span><span class=mord><span class="mopen nulldelimiter"></span><span class=mfrac><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:1.01em><span style=top:-2.5703em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style=position:relative;top:0>∑</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.8852em><span style=margin-left:0;margin-right:.0714em;top:-2.1786em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style=margin-right:.0714em;top:-2.8971em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.10903em>N</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3214em><span></span></span></span></span></span></span><span class="mspace mtight" style=margin-right:.1952em></span><span class="mord mathnormal mtight">Va</span><span class="mord mathnormal mtight" style=margin-right:.02778em>r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2963em><span style=margin-left:-.0269em;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1645em><span style=margin-left:-.0528em;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style=top:-3.23em><span class=pstrut style=height:3em></span><span class=frac-line style=border-bottom-width:.04em></span></span><span style=top:-3.485em><span class=pstrut style=height:3em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Va</span><span class="mord mathnormal mtight" style=margin-right:.02778em>r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.02691em>w</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2963em><span style=margin-left:-.0269em;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1645em><span style=margin-left:-.0528em;margin-right:.0714em;top:-2.357em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.143em><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.6547em><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style=top:0><span class="delimsizing size2">)</span></span></span></span></span></span>.<p>Computing this for each decade gives a range of Shannon entropies between <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>[</mo><mn>7.27</mn><mo>−</mo><mn>7.49</mn><mo stretchy=false>]</mo></mrow><annotation encoding=application/x-tex>[7.27-7.49]</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class=mopen>[</span><span class=mord>7.27</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.25em;height:1em></span><span class=mord>7.49</span><span class=mclose>]</span></span></span></span>, indicating that fewer than 8 factors contribute to the variance of the results. As with the variance explained for single stocks, for portfolios the market beta <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>β</mi><mrow><mi mathvariant=normal>m</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>k</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>t</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\beta_{\mathrm{market}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">market</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> is most informative, explaining 25.6% of returns, followed by <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>β</mi><mn>5</mn></msub></mrow><annotation encoding=application/x-tex>\beta_5</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> (16.4%), <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>β</mi><mn>6</mn></msub></mrow><annotation encoding=application/x-tex>\beta_6</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> (15.5%), <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>β</mi><mn>2</mn></msub></mrow><annotation encoding=application/x-tex>\beta_2</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal" style=margin-right:.05278em>β</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-left:-.0528em;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> (11.2%).<h4 id=optimisation-and-turnover>Optimisation and Turnover<a title="Permanent link" class=headerlink href=#optimisation-and-turnover></a></h4><p>The final two latent variables are partitioned to explore the relationship between weights and historical returns <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>w</mi><mi mathvariant=bold>r</mi></mrow><annotation encoding=application/x-tex>\mathbf{w} \mathbf{r}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4444em></span><span class="mord mathbf">wr</span></span></span></span>, and the relative turnover rate <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>w</mi><mi>t</mi></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>t</mi><mo lspace=0em rspace=0em>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>{w}_{t} - {w}_{t{-}1}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.7333em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=vertical-align:-.2083em;height:.6389em></span><span class=mord><span class=mord><span class="mord mathnormal" style=margin-right:.02691em>w</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3011em><span style=margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight"><span class="mord mtight">−</span></span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2083em><span></span></span></span></span></span></span></span></span></span>.<p>Inspection of the two latent variables show that neither have high variation and are unlikely to make much difference in the resulting reconstructed allocation. The two latent variables are also highly correlated with an <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>R</mi></mrow><annotation encoding=application/x-tex>R</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal" style=margin-right:.00773em>R</span></span></span></span>-squared of approximately 0.9, meaning that the neural network associates extreme scores on the Sharpe ratio with extreme scores on turnover. The direction of that relationship is not clear from the neural network, but investigating trends among the strategies as defined by Lipper gives insight. The two latent variables group together S&P 500 index funds and large cap core funds. Value funds overlap moderately with the two aforementioned types, and growth funds are separate and show the largest variation in values on the latent variables. This coincides with the real-world statistics, where growth funds tend to display larger volatility, higher factor drift and higher turnover rates.<h3 id=results-on-anchor-metrics>Results on Anchor-Metrics<a title="Permanent link" class=headerlink href=#results-on-anchor-metrics></a></h3><p>Recall, we introduced three losses that not only help anchor the generator and discriminator, but which are also easily interpretable by the practitioner as summary statistics of the performance of the model on a validation set. The summary statistics are Equations <a href=#equation:mean_exposure_regularization>[equation:mean_exposure_regularization]</a>,<a href=#equation:sharpe_regularization>[equation:sharpe_regularization]</a>,<a href=#equation:turnover_regularization>[equation:turnover_regularization]</a>. These are summarised in Figure <a href=#table:results_table_lipper_reconstruction>1.4</a>, where we present the summary statistics averaged over all funds in the given Lipper Class for January 2020.<table><thead><tr><th>Lipper Class<th><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>E</mi><mi mathvariant=normal>x</mi><mi mathvariant=normal>p</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>s</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>e</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{Exposure}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Exposure</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span><th><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>S</mi><mi mathvariant=normal>h</mi><mi mathvariant=normal>a</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>p</mi><mi mathvariant=normal>e</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{Sharpe}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.2861em;height:.9694em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3361em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Sharpe</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2861em><span></span></span></span></span></span></span></span></span></span><th><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=script>L</mi><mrow><mi mathvariant=normal>T</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>n</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>v</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>r</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\mathcal{L}_{\mathrm{Turnover}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.15em;height:.8333em></span><span class=mord><span class="mord mathcal">L</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Turnover</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><tbody><tr><td>S&P 500 Index<td>6.2%<td>0.141<td>9.4%<tr><td>Value<td>6.6%<td>0.196<td>11.7%<tr><td>Core<td>7.9%<td>0.171<td>11.4%<tr><td>Growth<td>9.0%<td>0.163<td>13.1%<tr><td>Income<td>5.5%<td>0.199<td>12.6%</table><dl><dd>This table compares the regularisation losses, breaking them by reference Lipper class. We observe that the strategy-modelling neural network performs better for index funds, where the regularisation losses are all lower than for other categories. Other results are more mixed, though value funds are often easily constructed, and growth funds are more difficult to replicate.</dl><p>We summarise the regularisation losses for various classes, as a heterogeneity is observed in the performance of the model. As is mirrored in earlier experiments on factor exposure, turnover and optimisation, simple strategies such as the S&P 500 index strategy is easy to replicate, with the network obtaining the lowest losses. Again, more volatile strategies such as Growth strategies, which also show the largest variation in the data, are more difficult to replicate.<p>Note also that the relative weights of these losses is set rather arbitrarily to have the same standard error close to the end of training, whereas other schemes to set the weights may result in different outcomes, perhaps trading performance on one aspect for that in another, which we have not fully explored in this analysis.<h3 id=section:gan_based_unsupervised_strategy>GAN-based Unsupervised Strategy Learning<a title="Permanent link" class=headerlink href=#section:gan_based_unsupervised_strategy></a></h3><p>In Figure <a href=#figure:latent_space_visual>1.6</a> we visualise the latent space of the strategy representation <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϕ</mi><mi>a</mi></msub></mrow><annotation encoding=application/x-tex>\phi_a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> for funds <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>a</mi></mrow><annotation encoding=application/x-tex>a</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=height:.4306em></span><span class="mord mathnormal">a</span></span></span></span> with a reference Lipper classification. We will evaluate this qualitatively, as the connection between the latent space representation and the practical strategy of allocating the weights is complex.<p>The first eight latent variables are those we reserved for the encoder to encode information relating to factor exposures. As discussed before, there is excess capacity in the network, as we see a simple relation between the latter pairs <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>5</mn><mo separator=true>,</mo><mn>6</mn></mrow><annotation encoding=application/x-tex>5,6</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8389em></span><span class=mord>5</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>6</span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>7</mn><mo separator=true>,</mo><mn>8</mn></mrow><annotation encoding=application/x-tex>7,8</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8389em></span><span class=mord>7</span><span class=mpunct>,</span><span class=mspace style=margin-right:.1667em></span><span class=mord>8</span></span></span></span>, which suggest that the network has unused degrees of freedom to capture additional information about the strategy. The fifth panel compares the latent dimension that encodes information about the weighted returns in the backtest <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϕ</mi><mrow><mi mathvariant=normal>r</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>t</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>n</mi><mi mathvariant=normal>s</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\phi_{\mathrm{returns}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.2806em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">returns</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span> and the dimension partitioned to capture information about the turnover rate <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϕ</mi><mrow><mi mathvariant=normal>T</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>n</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>v</mi><mi mathvariant=normal>e</mi><mi mathvariant=normal>r</mi></mrow></msub></mrow><annotation encoding=application/x-tex>\phi_{\mathrm{Turnover}}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.1944em;height:.8889em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.3283em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">Turnover</span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span>. It is clear that these separately encoded aspects of the investment strategy correlate, primarily because the set of growth funds lies outside the main cluster. This suggests that these two latent variables could be picking up a common cause (or confounder): for example, it is known that growth stocks’ returns exhibit larger volatility that other stocks, causing growth funds’ returns to differ from other funds and also making it difficult to track a growth style exposure resulting in larger turnover. Alternatively, the correlation of these variables can be coincidental: growth funds could be optimising their portfolio differently independent of their turnover, and that information about optimising behaviour is abstractly encoded in such a way that it appears to correlate with their typically larger turnover.<figure id=figure:latent_space_visual><img src=/images/opponent_modelling_strategies_training_2.png><figcaption>These plots of the strategy latent space <span class="math inline"><strong>ϕ</strong></span> give a qualitative insight into the latent-space representation learned by the neural network in this chapter. The date is again year-end 2019. The latent dimensions <span class="math inline"><em>ϕ</em><sub>Exposure<sub>1</sub></sub></span>-<span class="math inline"><em>ϕ</em><sub>Exposure<sub>8</sub></sub></span> are encoded by the encoder partition that looks the distribution of portfolio risk-factor exposures <span class="math inline"><strong>w</strong><strong>β</strong></span>. The latent dimension <span class="math inline"><em>ϕ</em><sub>Sharpe</sub></span> encodes the weighted returns <span class="math inline"><strong>w</strong><strong>r</strong></span> and the latent dimension <span class="math inline"><em>ϕ</em><sub>Turnover</sub></span> encodes the time-difference in weights <span class="math inline"><strong>w</strong><sub><em>t</em></sub> − <strong>w</strong><sub><em>t</em> − 1</sub></span>. Each point represents one investment fund, and the points are coloured by the reference Lipper class, which is not part of the input to the model but which helps interpret the result.</figcaption></figure><h2 id=conclusions>Conclusions<a title="Permanent link" class=headerlink href=#conclusions></a></h2><p>Fund managers exhibit coordination on stable factor exposures. Index funds, as expected, show the least drift, while growth-oriented funds exhibit the highest average drift. This indicates that maintaining stable exposure to growth-related factors is more challenging due to underlying volatility and market dynamics. The majority of portfolios deviate from the theoretical Sharpe-ratio optimal frontier. While some funds align closely with the efficient frontier, most portfolios appear influenced by constraints or objectives beyond pure risk-reward optimisation, such as turnover minimisation, liquidity considerations, or dynamic market conditions.<p>Analysis of intra-firm differences among growth and value funds suggests significant variation in how fund managers interpret and implement investment styles. This diversity underscores the importance of flexible models that accommodate heterogeneity across strategies.<p>The neural network model effectively captured key portfolio characteristics, such as risk-factor exposures and turnover. However, latent variables primarily summarised simple statistics rather than complex interdependencies, reflecting limited information content in observed portfolios beyond the average factor exposure. Growth funds display higher turnover and larger Sharpe-ratio variation compared to other classes. These differences are captured effectively in latent representations, suggesting that these metrics are fundamental to distinguishing growth strategies from other styles<p>Many of these features are computationally intensive to test at scale, as testing against a null model requires sampling from a complicated distribution that may be shaped by difficult-to-satisfy constraints. The GAN provides a framework for replicating investment strategies but foregoes easy interpretation. Regularisation terms based on Sharpe ratio, turnover, and factor exposures help stabilise training and guide the model toward realistic portfolio replication<h3 id=discussion>Discussion<a title="Permanent link" class=headerlink href=#discussion></a></h3><p>Interpretability remains a critical limitation, particularly for applications requiring transparency, such as regulatory settings. The GAN-based architecture demonstrated its usefulness in generating portfolio weights conditional on a given strategy. The discriminator’s learned criteria and latent space structure are difficult to interpret directly. Future work should explore better explainable models.<p>The monthly frequency of holdings data imposes significant limitations on reconstructing dynamic trading strategies. Higher-frequency data is invaluable. Alternatively, other data sources such as agent-based models could serve as sources for data. Using those models, the strategy encoder could learn pure-strategy archetypes, which when classifying real-world strategies would be mixed together in again a continuous classification.<p>Null-model testing revealed that while fund classifications are largely stable, distinctions between classes are less pronounced, and that there is much overlap in terms of the risk factor exposure for most Lipper classes of U.S. equities funds. Growth funds stand out as an exception, showing greater internal variability, but overall differences between classes lacked statistical significance. This suggests a need for richer datasets or more sophisticated models to capture subtle distinctions.<p>Because the number of observations per fund is quite limited with at most monthly portfolio snapshots, it is questionable that the strategy network can fully learn and generalise such complex operations as learning to Markowitz-optimise or target a specific volatility. Knowing that these aspects are almost universally tracked by real fund managers, these could perhaps be modelled as explicit components in the neural network.<p>Future studies could incorporate advanced metrics like maximum drawdown, skewness, or kurtosis to evaluate portfolios comprehensively. These metrics could better capture non-linear risk preferences or optimisations, and neural networks are suited to model these complicated aspects.<p>In conclusion, this chapter provides a foundation for understanding and replicating investment strategies using a combination of factor models, machine learning, and generative methods. Despite challenges in interpretability and data limitations, the methods developed here pave the way for more robust and nuanced analyses of portfolio management practices.<p>When it comes to classification, it appears there are few instances of an archetypal implementation of a strategy: under all factor models that the portfolio holdings data was tested, the different portfolios formed a continuum in factor space.<p>The VAE-based factor model nor the GAN-based neural network do not encode stocks and funds respectively, with the goal of matching the Lipper classification. Taking the mean exposures of a fund is closest in spirit to the approach taken by Lipper, and it is thus no surprise that the experiment of Section <a href=#section:model_equivalence_testing>1.3.1.2</a> (Table <a href=#table:classification_summary>1.2</a>) yields such high similarity. What is surprising however is that so much structure remains visible in the unsupervised approach in Section <a href=#section:gan_based_unsupervised_strategy>1.4.5</a>. Particularly in Figure <a href=#figure:latent_space_visual>1.6</a>, in the first panel we see that the <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϕ</mi><msub><mrow><mi mathvariant=normal>e</mi><mi mathvariant=normal>x</mi><mi mathvariant=normal>p</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>s</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>e</mi></mrow><mn>1</mn></msub></msub></mrow><annotation encoding=application/x-tex>\phi_{\mathrm{exposure}_1}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.3361em;height:1.0305em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">exposure</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1944em><span style=margin-right:.0714em;top:-2.2341em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2659em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3361em><span></span></span></span></span></span></span></span></span></span> and <span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi>ϕ</mi><msub><mrow><mi mathvariant=normal>e</mi><mi mathvariant=normal>x</mi><mi mathvariant=normal>p</mi><mi mathvariant=normal>o</mi><mi mathvariant=normal>s</mi><mi mathvariant=normal>u</mi><mi mathvariant=normal>r</mi><mi mathvariant=normal>e</mi></mrow><mn>2</mn></msub></msub></mrow><annotation encoding=application/x-tex>\phi_{\mathrm{exposure}_2}</annotation></semantics></math></span><span aria-hidden=true class=katex-html><span class=base><span class=strut style=vertical-align:-.3361em;height:1.0305em></span><span class=mord><span class="mord mathnormal">ϕ</span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1514em><span style=margin-left:0;margin-right:.05em;top:-2.55em><span class=pstrut style=height:2.7em></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">exposure</span></span><span class=msupsub><span class="vlist-t vlist-t2"><span class=vlist-r><span class=vlist style=height:.1944em><span style=margin-right:.0714em;top:-2.2341em><span class=pstrut style=height:2.5em></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2659em><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.3361em><span></span></span></span></span></span></span></span></span></span> separate the various classes well. The same variational methods that were applied to the factor model could in the future also be applied to regularise the layout of the latent space in this model, perhaps improving separation, and yielding better performance on unseen data.<p>The Lipper classes do serve as a useful reference and aid in implementation. This makes us reflect on using such established models as methods to make more advanced neural-networks more interpretable, by for example using them to construct archetypal or pure strategies that serve as a reference in the latent space. Perhaps neural networks operating on mixed modalities could construct explanations alongside the factor models and strategy classifications.<div class=footnote><hr><ol><li id=fn:1><p>In essence, utility functions. <a title="Jump back to footnote 1 in the text" class=footnote-backref href=#fnref:1>↩</a></p></ol></div></section><footer aria-label="Article footer"><div class=tags><a href=/tag/market-ecology.html>market-ecology</a><a href=/tag/portfolio-management.html>portfolio-management</a><a href=/tag/gan.html>gan</a></div><div class=post-footer><div class=poster-info><div class=pure-u-3-4><h3 class=author-name><a href=/author/maarten-p-scholl.html>Maarten P. Scholl</a></h3><p class=author-description></div></div><figure class=post-category-info><a href=/category/finance.html><img alt="Category Finance" src=https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/NGC_3923_Elliptical_Shell_Galaxy.jpg/220px-NGC_3923_Elliptical_Shell_Galaxy.jpg></a><figcaption class=post-category-caption><h3 class=author-name><a href=/category/finance.html>Finance</a></h3> <p class=author-description>Finance</p></figcaption></figure></div></footer></main><footer aria-label="Site footer" class=index-footer><a title="Simulating Financial Markets" href=/>Simulating Financial Markets</a> —<a href=https://github.com/INET-Complexity/ESL/>Economic Simulation Library</a></footer>